<!doctype html>
<html class="no-js">
  <head><meta charset="utf-8"/>
    <meta name="viewport" content="width=device-width,initial-scale=1"/>
    <meta name="color-scheme" content="light dark"><meta name="generator" content="Docutils 0.17.1: http://docutils.sourceforge.net/" />
<link rel="index" title="Index" href="../../../genindex.html" /><link rel="search" title="Search" href="../../../search.html" /><link rel="next" title="Multiphysics Examples" href="../../multiphysics/multiphysics.html" /><link rel="prev" title="8. 2D Taylor-Couette flow using Nitsche immersed boundary" href="../2d-taylor-couette-flow-nitsche/2d-taylor-couette-flow-nitsche.html" />

    <meta name="generator" content="sphinx-4.3.1, furo 2021.11.23"/>
        <title>9. 3D Mixer with pitched-blade turbine impeller using Nitsche immersed boundary - Lethe documentation</title>
      <link rel="stylesheet" type="text/css" href="../../../_static/pygments.css" />
    <link rel="stylesheet" type="text/css" href="../../../_static/styles/furo.css?digest=7f0192ddeb2adecfbaa87ffbcf67d16358b30bc1" />
    <link rel="stylesheet" type="text/css" href="../../../_static/styles/furo-extensions.css?digest=0af69da206d614734f649b27d4cdc2dd6c31f41d" />
    
    


<style>
  body {
    --color-code-background: #f8f8f8;
  --color-code-foreground: black;
  
  }
  body[data-theme="dark"] {
    --color-code-background: #202020;
  --color-code-foreground: #d0d0d0;
  
  }
  @media (prefers-color-scheme: dark) {
    body:not([data-theme="light"]) {
      --color-code-background: #202020;
  --color-code-foreground: #d0d0d0;
  
    }
  }
</style></head>
  <body>
    <script>
      document.body.dataset.theme = localStorage.getItem("theme") || "auto";
    </script>
    
<svg xmlns="http://www.w3.org/2000/svg" style="display: none;">
  <symbol id="svg-toc" viewBox="0 0 24 24">
    <title>Contents</title>
    <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round">
      <path stroke="none" d="M0 0h24v24H0z" />
      <line x1="4" y1="6" x2="20" y2="6" />
      <line x1="10" y1="12" x2="20" y2="12" />
      <line x1="6" y1="18" x2="20" y2="18" />
    </svg>
  </symbol>
  <symbol id="svg-menu" viewBox="0 0 24 24">
    <title>Menu</title>
    <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather-menu">
      <line x1="3" y1="12" x2="21" y2="12"></line>
      <line x1="3" y1="6" x2="21" y2="6"></line>
      <line x1="3" y1="18" x2="21" y2="18"></line>
    </svg>
  </symbol>
  <symbol id="svg-arrow-right" viewBox="0 0 24 24">
    <title>Expand</title>
    <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather-chevron-right">
      <polyline points="9 18 15 12 9 6"></polyline>
    </svg>
  </symbol>
  <symbol id="svg-sun" viewBox="0 0 24 24">
    <title>Light mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round" class="feather-sun">
      <circle cx="12" cy="12" r="5"></circle>
      <line x1="12" y1="1" x2="12" y2="3"></line>
      <line x1="12" y1="21" x2="12" y2="23"></line>
      <line x1="4.22" y1="4.22" x2="5.64" y2="5.64"></line>
      <line x1="18.36" y1="18.36" x2="19.78" y2="19.78"></line>
      <line x1="1" y1="12" x2="3" y2="12"></line>
      <line x1="21" y1="12" x2="23" y2="12"></line>
      <line x1="4.22" y1="19.78" x2="5.64" y2="18.36"></line>
      <line x1="18.36" y1="5.64" x2="19.78" y2="4.22"></line>
    </svg>
  </symbol>
  <symbol id="svg-moon" viewBox="0 0 24 24">
    <title>Dark mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round" class="icon-tabler-moon">
      <path stroke="none" d="M0 0h24v24H0z" fill="none" />
      <path d="M12 3c.132 0 .263 0 .393 0a7.5 7.5 0 0 0 7.92 12.446a9 9 0 1 1 -8.313 -12.454z" />
    </svg>
  </symbol>
  <symbol id="svg-sun-half" viewBox="0 0 24 24">
    <title>Auto light/dark mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round" class="icon-tabler-shadow">
      <path stroke="none" d="M0 0h24v24H0z" fill="none"/>
      <circle cx="12" cy="12" r="9" />
      <path d="M13 12h5" />
      <path d="M13 15h4" />
      <path d="M13 18h1" />
      <path d="M13 9h4" />
      <path d="M13 6h1" />
    </svg>
  </symbol>
</svg>

<input type="checkbox" class="sidebar-toggle" name="__navigation" id="__navigation">
<input type="checkbox" class="sidebar-toggle" name="__toc" id="__toc">
<label class="overlay sidebar-overlay" for="__navigation">
  <div class="visually-hidden">Hide navigation sidebar</div>
</label>
<label class="overlay toc-overlay" for="__toc">
  <div class="visually-hidden">Hide table of contents sidebar</div>
</label>



<div class="page">
  <header class="mobile-header">
    <div class="header-left">
      <label class="nav-overlay-icon" for="__navigation">
        <div class="visually-hidden">Toggle site navigation sidebar</div>
        <i class="icon"><svg><use href="#svg-menu"></use></svg></i>
      </label>
    </div>
    <div class="header-center">
      <a href="../../../index.html"><div class="brand">Lethe  documentation</div></a>
    </div>
    <div class="header-right">
      <div class="theme-toggle-container theme-toggle-header">
        <button class="theme-toggle">
          <div class="visually-hidden">Toggle Light / Dark / Auto color theme</div>
          <svg class="theme-icon-when-auto"><use href="#svg-sun-half"></use></svg>
          <svg class="theme-icon-when-dark"><use href="#svg-moon"></use></svg>
          <svg class="theme-icon-when-light"><use href="#svg-sun"></use></svg>
        </button>
      </div>
      <label class="toc-overlay-icon toc-header-icon" for="__toc">
        <div class="visually-hidden">Toggle table of contents sidebar</div>
        <i class="icon"><svg><use href="#svg-toc"></use></svg></i>
      </label>
    </div>
  </header>
  <aside class="sidebar-drawer">
    <div class="sidebar-container">
      
      <div class="sidebar-sticky"><a class="sidebar-brand" href="../../../index.html">
  
  
  <span class="sidebar-brand-text">Lethe  documentation</span>
  
</a><form class="sidebar-search-container" method="get" action="../../../search.html" role="search">
  <input class="sidebar-search" placeholder=Search name="q" aria-label="Search">
  <input type="hidden" name="check_keywords" value="yes">
  <input type="hidden" name="area" value="default">
</form>
<div id="searchbox"></div><div class="sidebar-scroll"><div class="sidebar-tree">
  <ul class="current">
<li class="toctree-l1 has-children"><a class="reference internal" href="../../../installation/installation.html">Installation</a><input class="toctree-checkbox" id="toctree-checkbox-1" name="toctree-checkbox-1" role="switch" type="checkbox"/><label for="toctree-checkbox-1"><div class="visually-hidden">Toggle child pages in navigation</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../../../installation/regular_installation.html">Regular installation</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../installation/docker.html">Docker</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../installation/compute_canada.html">Running Lethe on Compute Canada clusters</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../../structure.html">Folder structure of Lethe</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../first_simulation.html">Launching your first simulation</a></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../../../parameters/parameters.html">Parameters guide</a><input class="toctree-checkbox" id="toctree-checkbox-2" name="toctree-checkbox-2" role="switch" type="checkbox"/><label for="toctree-checkbox-2"><div class="visually-hidden">Toggle child pages in navigation</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l2 has-children"><a class="reference internal" href="../../../parameters/cfd/cfd.html">General, CFD and Multiphysics</a><input class="toctree-checkbox" id="toctree-checkbox-3" name="toctree-checkbox-3" role="switch" type="checkbox"/><label for="toctree-checkbox-3"><div class="visually-hidden">Toggle child pages in navigation</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l3"><a class="reference internal" href="../../../parameters/cfd/simulation_control.html">Simulation Control</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../parameters/cfd/physical_properties.html">Physical Properties</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../parameters/cfd/initial_conditions.html">Initial Conditions</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../parameters/cfd/mesh.html">Mesh</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../parameters/cfd/mesh_adaptation_control.html">Mesh Adaptation Control</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../parameters/cfd/fem.html">Finite element interpolation (FEM)</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../parameters/cfd/boundary_conditions_cfd.html">Boundary conditions - CFD</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../parameters/cfd/source_term.html">Source term</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../parameters/cfd/analytical_solution.html">Analytical solution</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../parameters/cfd/force_and_torque.html">Force and torque calculation</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../parameters/cfd/post_processing.html">Post-Processing</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../parameters/cfd/timer.html">Timer</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../parameters/cfd/non-linear_solver_control.html">Non-linear Solver Control</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../parameters/cfd/linear_solver_control.html">Linear Solver Control</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../parameters/cfd/stabilization.html">Stabilization</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../parameters/cfd/multiphysics.html">Multiphysics</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../parameters/cfd/volume_of_fluid.html">Volume of Fluid</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../parameters/cfd/boundary_conditions_multiphysics.html">Boundary Contitions - Multiphysics</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../parameters/cfd/nitsche.html">Nitsche</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../parameters/cfd/restart.html">Restart</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../parameters/cfd/dynamic_flow_control.html">Dynamic flow control</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../parameters/cfd/laser_heat_source.html">Laser heat source</a></li>
</ul>
</li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../../../parameters/dem/dem.html">Discrete Element Method (DEM)</a><input class="toctree-checkbox" id="toctree-checkbox-4" name="toctree-checkbox-4" role="switch" type="checkbox"/><label for="toctree-checkbox-4"><div class="visually-hidden">Toggle child pages in navigation</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l3"><a class="reference internal" href="../../../parameters/dem/simulation_control.html">Simulation Control</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../parameters/dem/timer.html">Timer</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../parameters/dem/test.html">Test</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../parameters/dem/model_parameters.html">Model Parameters</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../parameters/dem/lagrangian_physical_properties.html">Lagrangian Physical Properties</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../parameters/dem/insertion_info.html">Insertion Info</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../parameters/dem/floating_walls.html">Floating Walls</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../parameters/dem/mesh.html">Mesh</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../parameters/dem/boundary_conditions.html">Boundary Conditions</a></li>
</ul>
</li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../../../parameters/unresolved_cfd-dem/unresolved_cfd-dem.html">Unresolved CFD-DEM</a><input class="toctree-checkbox" id="toctree-checkbox-5" name="toctree-checkbox-5" role="switch" type="checkbox"/><label for="toctree-checkbox-5"><div class="visually-hidden">Toggle child pages in navigation</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l3"><a class="reference internal" href="../../../parameters/unresolved_cfd-dem/void_fraction.html">Void Fraction</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../parameters/unresolved_cfd-dem/cfd_dem.html">CFD-DEM</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../../parameters/resolved_cfd-dem/resolved_cfd-dem.html">Resolved CFD-DEM</a></li>
</ul>
</li>
<li class="toctree-l1 current has-children"><a class="reference internal" href="../../examples.html">Examples</a><input checked="" class="toctree-checkbox" id="toctree-checkbox-6" name="toctree-checkbox-6" role="switch" type="checkbox"/><label for="toctree-checkbox-6"><div class="visually-hidden">Toggle child pages in navigation</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul class="current">
<li class="toctree-l2 current has-children"><a class="reference internal" href="../incompressible-flow.html">Incompressible Flow</a><input checked="" class="toctree-checkbox" id="toctree-checkbox-7" name="toctree-checkbox-7" role="switch" type="checkbox"/><label for="toctree-checkbox-7"><div class="visually-hidden">Toggle child pages in navigation</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul class="current">
<li class="toctree-l3"><a class="reference internal" href="../2d-lid%E2%80%90driven-cavity-flow/lid%E2%80%90driven-cavity-flow.html">1. 2D Lid-driven cavity flow</a></li>
<li class="toctree-l3"><a class="reference internal" href="../2d-flow-around-cylinder/2d-flow-around-cylinder.html">2. 2D Flow around a cylinder</a></li>
<li class="toctree-l3"><a class="reference internal" href="../2d-taylor-couette-flow/2d-taylor-couette-flow.html">3. 2D Taylor-Couette flow</a></li>
<li class="toctree-l3"><a class="reference internal" href="../2d-backward-facing-step/2d-backward-facing-step.html">4. 2D Flow past a backward-facing step</a></li>
<li class="toctree-l3"><a class="reference internal" href="../2d-transient-around-ahmed-body/2d-transient-around-ahmed-body.html">5. 2D Transient flow around an Ahmed body</a></li>
<li class="toctree-l3"><a class="reference internal" href="../3d-flow-around-sphere/flow-around-sphere.html">6. 3D Flow around a sphere</a></li>
<li class="toctree-l3"><a class="reference internal" href="../3d-flow-over-periodic-hills/3d-flow-over-periodic-hills.html">7. 3D Flow over periodic hills</a></li>
<li class="toctree-l3"><a class="reference internal" href="../2d-taylor-couette-flow-nitsche/2d-taylor-couette-flow-nitsche.html">8. 2D Taylor-Couette flow using Nitsche immersed boundary</a></li>
<li class="toctree-l3 current current-page"><a class="current reference internal" href="#">9. 3D Mixer with pitched-blade turbine impeller using Nitsche immersed boundary</a></li>
</ul>
</li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../../multiphysics/multiphysics.html">Multiphysics Examples</a><input class="toctree-checkbox" id="toctree-checkbox-8" name="toctree-checkbox-8" role="switch" type="checkbox"/><label for="toctree-checkbox-8"><div class="visually-hidden">Toggle child pages in navigation</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l3"><a class="reference internal" href="../../multiphysics/tracer-through-cad-junction/tracer-through-cad-junction.html">1. Tracer through CAD Junction in Simplex</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../multiphysics/stefan_problem/stefan_problem.html">2. Stefan problem : melting of a solid</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../multiphysics/warming-up-a-viscous-fluid/warming-up-a-viscous-fluid.html">3. Warming Up a Viscous Fluid</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../multiphysics/dam-break-VOF/dam-break-VOF.html">4. Dam break VOF</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../multiphysics/rising-bubble-VOF/rising-bubble-VOF.html">5. Rising bubble VOF</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../multiphysics/laser-melting/laser-melting.html">6. Laser melting</a></li>
</ul>
</li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../../dem/dem.html">Discrete Element Method</a><input class="toctree-checkbox" id="toctree-checkbox-9" name="toctree-checkbox-9" role="switch" type="checkbox"/><label for="toctree-checkbox-9"><div class="visually-hidden">Toggle child pages in navigation</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l3"><a class="reference internal" href="../../dem/packing-in-circle/packing-in-circle.html">1. Packing in Circle</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../dem/packing-in-ball/packing-in-ball.html">2. Packing in Ball</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../dem/rotating-drum/rotating-drum.html">3. Rotating Drum</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../dem/rotating-drum-with-post-processing/rotating-drum-with-post-processing.html">4. Rotating Drum with Post-Processing</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../dem/rotation-of-box/rotation-of-box.html">5. Rotation of Box</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../dem/silo/silo.html">6. Silo</a></li>
</ul>
</li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../../unresolved_cfd-dem/unresolved_cfd-dem.html">Unresolved CFD-DEM</a><input class="toctree-checkbox" id="toctree-checkbox-10" name="toctree-checkbox-10" role="switch" type="checkbox"/><label for="toctree-checkbox-10"><div class="visually-hidden">Toggle child pages in navigation</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l3"><a class="reference internal" href="../../unresolved_cfd-dem/cylindrical-packed-bed/cylindrical-packed-bed.html">1. Cylindrical Packed Bed</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../unresolved_cfd-dem/square-fluidized-bed/square-fluidized-bed.html">2. Gas-Solid Fluidized Bed</a></li>
</ul>
</li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../../resolved_cfd-dem/resolved_cfd-dem.html">Resolved CFD-DEM Examples</a><input class="toctree-checkbox" id="toctree-checkbox-11" name="toctree-checkbox-11" role="switch" type="checkbox"/><label for="toctree-checkbox-11"><div class="visually-hidden">Toggle child pages in navigation</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l3"><a class="reference internal" href="../../resolved_cfd-dem/cylinder-with-sharp-interface/cylinder-with-sharp-interface.html">1. Flow around a cylinder using the sharp interface method</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../resolved_cfd-dem/sedimentation-1-particle/sedimentation-1-particle.html">2. Sedimentation of one particle.</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../../../theory/theory.html">Theory</a><input class="toctree-checkbox" id="toctree-checkbox-12" name="toctree-checkbox-12" role="switch" type="checkbox"/><label for="toctree-checkbox-12"><div class="visually-hidden">Toggle child pages in navigation</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l2 has-children"><a class="reference internal" href="../../../theory/fluid_dynamics/fluid_dynamics.html">Fluid dynamics</a><input class="toctree-checkbox" id="toctree-checkbox-13" name="toctree-checkbox-13" role="switch" type="checkbox"/><label for="toctree-checkbox-13"><div class="visually-hidden">Toggle child pages in navigation</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l3"><a class="reference internal" href="../../../theory/fluid_dynamics/navier-stokes.html">The Incompressible Navier-Stokes equations</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../theory/fluid_dynamics/fem_formulation.html">Origin of the finite element formulation</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../theory/fluid_dynamics/stabilization.html">On the need for stabilization</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../theory/fluid_dynamics/rheology.html">Rheology and non-Newtonian fluids</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../../theory/unresolved_cfd-dem/unresolved_cfd-dem.html">Unresolved CFD-DEM coupling</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../../contributing.html">Contributing</a></li>
</ul>

</div>
</div>
      </div>
      
    </div>
  </aside>
  <div class="main">
    <div class="content">
      <div class="article-container">
        <div class="content-icon-container">
          <div class="theme-toggle-container theme-toggle-content">
            <button class="theme-toggle">
              <div class="visually-hidden">Toggle Light / Dark / Auto color theme</div>
              <svg class="theme-icon-when-auto"><use href="#svg-sun-half"></use></svg>
              <svg class="theme-icon-when-dark"><use href="#svg-moon"></use></svg>
              <svg class="theme-icon-when-light"><use href="#svg-sun"></use></svg>
            </button>
          </div>
          <label class="toc-overlay-icon toc-content-icon" for="__toc">
            <div class="visually-hidden">Toggle table of contents sidebar</div>
            <i class="icon"><svg><use href="#svg-toc"></use></svg></i>
          </label>
        </div>
        <article role="main">
          <section id="d-mixer-with-pitched-blade-turbine-impeller-using-nitsche-immersed-boundary">
<h1><span class="section-number">9. </span>3D Mixer with pitched-blade turbine impeller using Nitsche immersed boundary<a class="headerlink" href="#d-mixer-with-pitched-blade-turbine-impeller-using-nitsche-immersed-boundary" title="Permalink to this headline">¶</a></h1>
<p>Simulation of mixing in stirred-tanks is one important industrial application which is often simulated with Lethe. Agitated vessels are widely applied in chemical engineering as product homogenizers, heat and mass transfer enhancers, and surface area maximizers in solid-fluid processes. Batch and Continuous Stirred Tank Reactors (CSTR), for example, are among the most often reactor models applied in chemical industries that can be simulated through computational fluid dynamics.</p>
<p>This example illustrates how the transient flow in a stirred-tank can be simulated by Lethe using the Nitsche immersed boundary formulation.</p>
<section id="features">
<h2><span class="section-number">9.1. </span>Features<a class="headerlink" href="#features" title="Permalink to this headline">¶</a></h2>
<ul class="simple">
<li><p>Solvers: <code class="docutils literal notranslate"><span class="pre">gls_nitsche_navier_stokes_33</span></code></p></li>
<li><p>Transient problem</p></li>
<li><p>Rotating complex solid modeled with Nitsche immersed boundary</p></li>
<li><p>Calculation of the average velocity</p></li>
</ul>
</section>
<section id="location-of-the-examples">
<h2><span class="section-number">9.2. </span>Location of the examples<a class="headerlink" href="#location-of-the-examples" title="Permalink to this headline">¶</a></h2>
<p><code class="docutils literal notranslate"><span class="pre">/examples/incompressible_flow/3d_nitsche_mixer_with_pbt_impeller/mixer.prm</span></code></p>
</section>
<section id="description-of-the-case">
<h2><span class="section-number">9.3. </span>Description of the case<a class="headerlink" href="#description-of-the-case" title="Permalink to this headline">¶</a></h2>
<p>We simulate the flow generated by a pitched blade turbine (PBT) in a stirred tank. The PBT is an axial impeller, which generates a flow pattern that amplifies axial circulation within the vessel (in opposition to radial impellers, e.g. Rushton turbines) [1].</p>
<p>The setup that we wish to simulate is schematized in the following figure:</p>
<blockquote>
<div><a class="reference internal image-reference" href="../../../_images/scheme_tank.png" id="geometry"><img alt="The geometry and boundary conditions" class="align-center" id="geometry" src="../../../_images/scheme_tank.png" style="height: 12cm;"/></a>
</div></blockquote>
<p>It consists of a <span class="math notranslate nohighlight">\(D\)</span> diameter PBT in a <span class="math notranslate nohighlight">\(T\)</span> diameter vessel. The vessel is at a clearance <span class="math notranslate nohighlight">\(C\)</span> from the bottom. For generalization purposes, we will consider <span class="math notranslate nohighlight">\(T=1\)</span> and make the problem dimensionless by considering all other dimensions as a ratio of <span class="math notranslate nohighlight">\(T\)</span>. The diameter of the impeller is <span class="math notranslate nohighlight">\(D/3\)</span> and the clearance is <span class="math notranslate nohighlight">\(D/4\)</span>. The Reynolds number of the flow will be controlled through the viscosity and the angular velocity of the impeller.</p>
<p>The PBT is rotating at a constant velocity. No-slip boundary conditions are applied on the lateral and bottom walls of the vessel. On the top surface, a slip boundary condition is applied to mimic the liquid’s free surface. This boundary condition is debatable. A do-nothing boundary condition could be used since free surfaces have constant pressure, but the slip boundary condition is generally significantly more numerically robust.</p>
<p>For this configuration, the Reynolds number is defined as:</p>
<blockquote>
<div><div class="math-wrapper"><div class="math notranslate nohighlight">
\[Re = \frac{ND^2}{\nu}\]</div></div>
</div></blockquote>
<p>where <span class="math notranslate nohighlight">\(N\)</span> is the angular velocity in Rotation Per Second (RPS) and <span class="math notranslate nohighlight">\(\nu\)</span> is the kinematic viscosity. We investigate this case at a Reynolds number of 300 for the flow reaches a pseudo steady-state. However, this example can easily be extended to higher Reynolds number values by lowering the kinematic viscosity. It will be necessary to increase the mesh resolution for the solution to be meaningfully accurate.</p>
</section>
<section id="parameter-file">
<h2><span class="section-number">9.4. </span>Parameter file<a class="headerlink" href="#parameter-file" title="Permalink to this headline">¶</a></h2>
<p>Except for the Nitsche immersed boundary, all other sections of the parameter file in the present case have been explained in previous examples. However, the important sections are briefly explained for completeness.</p>
<section id="simulation-control">
<h3><span class="section-number">9.4.1. </span>Simulation control<a class="headerlink" href="#simulation-control" title="Permalink to this headline">¶</a></h3>
<div class="highlight-text notranslate"><div class="highlight"><pre><span></span>subsection simulation control
  set method                  = bdf2
  set output name             = mixer
  set output path             = ./output/
  set output frequency        = 2
  set time end                = 5
  set time step               = 0.02
  set output boundaries       = true
end
</pre></div>
</div>
<p>Since the flow generated by the agitator is naturally transient, we use a second-order <code class="docutils literal notranslate"><span class="pre">bdf2</span></code> time-stepping method. We simulate the flow for a total of 5 seconds. We set <code class="docutils literal notranslate"><span class="pre">output</span> <span class="pre">boundaries</span> <span class="pre">=</span> <span class="pre">true</span></code> to generate an auxiliary file that highlights the equipment walls by hiding the cells of the mesh. This allows for a clearer visualization of the mixing setup.</p>
</section>
<section id="physical-properties">
<h3><span class="section-number">9.4.2. </span>Physical properties<a class="headerlink" href="#physical-properties" title="Permalink to this headline">¶</a></h3>
<div class="highlight-text notranslate"><div class="highlight"><pre><span></span>subsection physical properties
  subsection fluid 0
    set kinematic viscosity            = 0.001
  end
end
</pre></div>
</div>
<p>The kinematic viscosity is set to <span class="math notranslate nohighlight">\(0.001\)</span>. This, combined with the angular velocity of 1 RPS and the diameter of the impeller of 0.3, will allow us to simulate the vessel at <span class="math notranslate nohighlight">\(Re=300\)</span>.</p>
</section>
<section id="mesh">
<h3><span class="section-number">9.4.3. </span>Mesh<a class="headerlink" href="#mesh" title="Permalink to this headline">¶</a></h3>
<p>The <code class="docutils literal notranslate"><span class="pre">mesh</span></code> subsection specifies the computational grid:</p>
<div class="highlight-text notranslate"><div class="highlight"><pre><span></span>subsection mesh
    set type                 = dealii
    set grid type            = subdivided_cylinder
    set grid arguments       = 2:0.5:0.5
    set initial refinement   = 3
end
</pre></div>
</div>
<p>Because we use an immersed boundary approach, we only need to mesh the vessel without considering the impeller. This greatly simplifies the meshing process. The mesh can be generated straightforwardly using the deal.II mesh generator for a subdivided cylinder. We set the half-height and the radius of the vessel to be <span class="math notranslate nohighlight">\(0.5\)</span>. This will generate a vessel in which the axis of the impeller will be along the <span class="math notranslate nohighlight">\(x\)</span> coordinate. The bottom of the vessel will be on the <span class="math notranslate nohighlight">\(x=-0.5\)</span> plane. This is not really intuitive, but this is a consequence of some of the inherent limitations of the mesh generators. We refer to the documentation of the deal.ii <a class="reference external" href="https://www.dealii.org/current/doxygen/deal.II/namespaceGridGenerator.html">GridGenerator</a> for a detailed explanation of the mesh generators.</p>
</section>
<section id="boundary-conditions">
<h3><span class="section-number">9.4.4. </span>Boundary conditions<a class="headerlink" href="#boundary-conditions" title="Permalink to this headline">¶</a></h3>
<p>The <code class="docutils literal notranslate"><span class="pre">boundary</span> <span class="pre">conditions</span></code> subsection establishes the constraints on different parts of the domain:</p>
<div class="highlight-text notranslate"><div class="highlight"><pre><span></span>subsection boundary conditions
set number                  = 3
    subsection bc 0
        set id                = 0
        set type              = noslip
    end
    subsection bc 1
        set id                = 1
        set type              = noslip
    end
    subsection bc 2
        set id                = 2
        set type              = slip
    end
end
</pre></div>
</div>
<p>Three different boundary conditions are considered. On the lateral walls (<code class="docutils literal notranslate"><span class="pre">id=0</span></code>) and the bottom wall (<code class="docutils literal notranslate"><span class="pre">id=1</span></code>), a no-slip boundary condition applies whereas a slip boundary condition is imposed on the free surface at the top of the vessel (<code class="docutils literal notranslate"><span class="pre">id=2</span></code>). The boundary conditions are described in the <a class="reference internal" href="../../../parameters/cfd/boundary_conditions_cfd.html"><span class="doc">Boundary conditions - CFD</span></a> section of the documentation.</p>
</section>
<section id="nitsche-immersed-boundary-parameters">
<h3><span class="section-number">9.4.5. </span>Nitsche immersed boundary parameters<a class="headerlink" href="#nitsche-immersed-boundary-parameters" title="Permalink to this headline">¶</a></h3>
<p>This subsection is used to insert the immersed geometry and control its motion.</p>
<div class="highlight-text notranslate"><div class="highlight"><pre><span></span>set number of solids = 1
      set verbosity                    = verbose

subsection nitsche solid 0
        subsection mesh
              set type                 = gmsh
              set file name            = pbt.msh
        set simplex = true
        end
  subsection solid velocity
          set Function expression = 0 ; 1*2*3.1416*z ; -1*2*3.1416*y
  end

      set beta                        = 10
  set enable particles motion         = true
  set particles sub iterations      = 10
  set calculate torque on solid = true
end
</pre></div>
</div>
<p>First, we specify the number of immersed solid objects. In our case, since we only have the PBT, we set <code class="docutils literal notranslate"><span class="pre">number</span> <span class="pre">of</span> <span class="pre">solids=1</span></code>.  Setting <code class="docutils literal notranslate"><span class="pre">verbosity</span> <span class="pre">=</span> <span class="pre">true</span></code> enables the output of the solid object post-processing in the terminal.</p>
<p>For each Nitsche solid, multiple parameters have to be provided. First, the <code class="docutils literal notranslate"><span class="pre">mesh</span></code> subsection controls the mesh used for the Nitsche IB, working as a regular <code class="docutils literal notranslate"><span class="pre">mesh</span></code> subsection. In the present case, we import a GMSH mesh of the PBT made using simplices (tetrahedra). Hence, we set <code class="docutils literal notranslate"><span class="pre">simplex</span> <span class="pre">=</span> <span class="pre">true</span></code>.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>The Nitsche IB method works by forcing the fluid at the location of the gauss points of the solid triangulation in order to apply the no-slip boundary condition within the solid object. Consequently, the solid mesh should have a characteristic size that is of the same order as that used for the fluid dynamics problem. Using a finer mesh will not cause any problem, but will increase the computational cost without benefits.</p>
</div>
<p>We specify the <code class="docutils literal notranslate"><span class="pre">solid</span> <span class="pre">velocity</span></code> using a user-defined function. In the present case, the specified velocity induces a rotation around the <span class="math notranslate nohighlight">\(x\)</span> axis of the meshes, centered at <span class="math notranslate nohighlight">\((0,0,0)\)</span>. This corresponds to the location of the center of our PBT in the accompanying GMSH mesh.</p>
<p>The parameter <code class="docutils literal notranslate"><span class="pre">beta</span></code> controls the intensity of the Nitsche method application in the fluid region. Higher values of <code class="docutils literal notranslate"><span class="pre">beta</span></code> lead to stiffer problems but prevent the fluid from penetrating the solid. For flows with Reynolds numbers larger than one, we found that setting <code class="docutils literal notranslate"><span class="pre">beta</span></code> between 10 and 1000 leads to satisfactory results. For more viscous flows, higher values of <code class="docutils literal notranslate"><span class="pre">beta</span></code> should be used to compensate for the larger shear stresses acting on the immersed solid.</p>
<p>Nitsche method can be used with both static and dynamic immersed solid. When the velocity imposed on the solid leads to a motion of the solid, we must set <code class="docutils literal notranslate"><span class="pre">enable</span> <span class="pre">particles</span> <span class="pre">motion=true</span></code> . This option should only be set to true on the moving solids since it adds a non-negligible cost to the simulations. To ensure that particles are always located efficiently as they move through the cell, we set <code class="docutils literal notranslate"><span class="pre">particles</span> <span class="pre">sub</span> <span class="pre">iterations</span> <span class="pre">=</span> <span class="pre">10</span></code>. This enables particle displacing using 10 sub-steps, thus facilitating the detection of the cells in which they lie. Generally, it is a good practice to have sufficient particles sub iterations so as to ensure that particles do not move more than half a cell during a particle sub iteration.</p>
</section>
<section id="post-processing">
<h3><span class="section-number">9.4.6. </span>Post-processing<a class="headerlink" href="#post-processing" title="Permalink to this headline">¶</a></h3>
<p>It is often desirable to obtain the time-averaged velocity field when simulating a transient flow. This is achieved through the post-processing section. The averaging period is started after the flows start to stabilize and reach their pseudo steady-state. In this case, we assume it happens after two seconds. This choice is error-prone, but this can be mitigated by increasing the duration of simulations and using a longer averaging interval.</p>
<div class="highlight-text notranslate"><div class="highlight"><pre><span></span>subsection post-processing
   set calculate average velocities = true
   set initial time = 2
end
</pre></div>
</div>
</section>
<section id="non-linear-solver-parameters">
<h3><span class="section-number">9.4.7. </span>Non-linear solver parameters<a class="headerlink" href="#non-linear-solver-parameters" title="Permalink to this headline">¶</a></h3>
<p>Since this is a transient problem, it is not highly non-linear except for the first few iterations. Thus, we use standard non-linear solver parameters.</p>
<div class="highlight-text notranslate"><div class="highlight"><pre><span></span>subsection non-linear solver
  set tolerance               = 1e-4
  set max iterations          = 10
  set verbosity               = verbose
  set solver                  = inexact_newton
end
</pre></div>
</div>
<p>Because the assembly of the Nitsche restriction for the immersed boundary is relatively expensive, we reuse the Jacobian matrix as much as possible. This is accomplished by setting <code class="docutils literal notranslate"><span class="pre">solver=inexact_newton</span></code>.</p>
</section>
<section id="linear-solver-parameters">
<h3><span class="section-number">9.4.8. </span>Linear solver parameters<a class="headerlink" href="#linear-solver-parameters" title="Permalink to this headline">¶</a></h3>
<p>Relatively standard parameters are used for the linear solver. From our experience, the AMG preconditioner is more robust with the Nitsche IB than the traditional ILU.</p>
<div class="highlight-text notranslate"><div class="highlight"><pre><span></span>subsection linear solver
  set method                    = amg
  set max iters                 = 200
  set relative residual         = 1e-3
  set minimum residual          = 1e-7
  set amg preconditioner ilu fill                  = 0
  set amg preconditioner ilu absolute tolerance    = 1e-8
  set amg preconditioner ilu relative tolerance    = 2.00
  set amg aggregation threshold = 1e-10
  set amg smoother sweeps       = 2
  set amg smoother overlap      = 1
  set verbosity                 = verbose
  set max krylov vectors      = 200
end
</pre></div>
</div>
</section>
</section>
<section id="running-the-simulation">
<h2><span class="section-number">9.5. </span>Running the simulation<a class="headerlink" href="#running-the-simulation" title="Permalink to this headline">¶</a></h2>
<p>Launching the simulation is as simple as specifying the executable name and the parameter file. Assuming that the <code class="docutils literal notranslate"><span class="pre">gls_nitsche_navier_stokes_33</span></code> executable is within your path, the simulation can be launched by typing:</p>
<div class="highlight-text notranslate"><div class="highlight"><pre><span></span>gls_nitsche_navier_stokes_33 mixer.prm
</pre></div>
</div>
<p>Lethe generates a larger number of files when the Nitsche immersed boundary is used. The <code class="docutils literal notranslate"><span class="pre">mixer.pvd</span></code> contains the 3D visualization of the velocity, pressure, and auxiliary variables such as the average velocity. Additional files will also be generated, notably the <code class="docutils literal notranslate"><span class="pre">mixer_solid_triangulation_00.pvd</span></code> and <code class="docutils literal notranslate"><span class="pre">mixer_solid_particles_00.pvd</span></code>, corresponding to the Nitsche IB mesh and the discrete particles inserted at the Gauss points of the solid triangulation, respectively. The solid particles enable the Nitsche restriction visualization, while the solid triangulation is used for animation purposes.</p>
<section id="results">
<h3><span class="section-number">9.5.1. </span>Results<a class="headerlink" href="#results" title="Permalink to this headline">¶</a></h3>
<p>The following movie shows the evolution of the velocity magnitude as a function of time in a cut perpendicular to the radius of the vessel with and without the mesh :</p>
<iframe allowfullscreen="" frameborder="0" height="315" src="https://youtu.be/rt6PAvgMkio" width="560"></iframe><iframe allowfullscreen="" frameborder="0" height="315" src="https://youtu.be/jvaT76qBBTs" width="560"></iframe><p>Whereas the next one show the evolution of the axial velocity pattern in the same cut:</p>
<iframe allowfullscreen="" frameborder="0" height="315" src="https://youtu.be/8b0ETD8EkQc" width="560"></iframe><p>Finally, the following animation illustrates the axial velocity pattern in an axial cut of the vessel:</p>
<iframe allowfullscreen="" frameborder="0" height="315" src="https://youtu.be/_VUoN8TGsJ4" width="560"></iframe><p>From these animations, we can see that the impeller generates an axial pumping flow. The fluid is diagonally propelled from the blade to the lateral walls and rises along the outer periphery of the vessel before circulating down along the shaft. Although the transient flow patterns are clear, looking at the time-averaged velocity field is also relevant. The following figures show the time-averaged axial velocity in the axial plane:</p>
<blockquote>
<div><img alt="Time-averaged axial velocity" class="align-center" id="axial-velocity" src="../../../_images/averaged_axial_velocity.png"/>
</div></blockquote>
<p>Clearly, the fluid is descending along the shaft and rises along the lateral walls of the vessel.
Multiple analyses can be done with this type of simulation. For example, one can monitor the torque on the impeller as a function of the Reynolds number to generate the power curve of the agitator. One could also leverage the tracer multiphysics module to measure the mixing time of the tank and/or identify the presence of dead zones.</p>
</section>
</section>
<section id="possibilities-for-extension">
<h2><span class="section-number">9.6. </span>Possibilities for extension<a class="headerlink" href="#possibilities-for-extension" title="Permalink to this headline">¶</a></h2>
<ul class="simple">
<li><p><strong>Increase the Reynolds number:</strong> Using a finer grid, this example can be launched at even higher Reynolds numbers. In the latter case, the flow is significantly more unsteady.</p></li>
<li><p><strong>Calculate the mixing time using the passive tracer physics:</strong> Using the passive tracer physics and the built-in post-processing tool, the mixing time in the vessel can be easily calculated.</p></li>
</ul>
</section>
<section id="references">
<h2><span class="section-number">9.7. </span>References<a class="headerlink" href="#references" title="Permalink to this headline">¶</a></h2>
<p>[1] Paul, Edward L., Victor A. Atiemo-Obeng, and Suzanne M. Kresta, eds. Handbook of industrial mixing: science and practice. Vol. 1. John Wiley &amp; Sons, 2003.</p>
</section>
</section>

        </article>
      </div>
      <footer>
        
        <div class="related-pages">
          <a class="next-page" href="../../multiphysics/multiphysics.html">
              <div class="page-info">
                <div class="context">
                  <span>Next</span>
                </div>
                <div class="title">Multiphysics Examples</div>
              </div>
              <svg><use href="#svg-arrow-right"></use></svg>
            </a>
          <a class="prev-page" href="../2d-taylor-couette-flow-nitsche/2d-taylor-couette-flow-nitsche.html">
              <svg><use href="#svg-arrow-right"></use></svg>
              <div class="page-info">
                <div class="context">
                  <span>Previous</span>
                </div>
                
                <div class="title"><span class="section-number">8. </span>2D Taylor-Couette flow using Nitsche immersed boundary</div>
                
              </div>
            </a>
        </div>

        <div class="related-information">
              Copyright &#169; 2021, Lethe |
          Created using <a href="https://www.sphinx-doc.org/">Sphinx</a> and <a class="muted-link" href="https://pradyunsg.me">@pradyunsg</a>'s
          <a href="https://github.com/pradyunsg/furo">Furo theme</a>.
            | <a class="muted-link" href="../../../_sources/examples/incompressible-flow/3d_nitsche_mixer_with_pbt_impeller/nitsche_mixer_with_pbt_impeller.rst.txt"
               rel="nofollow">
              Show Source
            </a>
        </div>
        
      </footer>
    </div>
    <aside class="toc-drawer">
      
      
      <div class="toc-sticky toc-scroll">
        <div class="toc-title-container">
          <span class="toc-title">
            Contents
          </span>
        </div>
        <div class="toc-tree-container">
          <div class="toc-tree">
            <ul>
<li><a class="reference internal" href="#">9. 3D Mixer with pitched-blade turbine impeller using Nitsche immersed boundary</a><ul>
<li><a class="reference internal" href="#features">9.1. Features</a></li>
<li><a class="reference internal" href="#location-of-the-examples">9.2. Location of the examples</a></li>
<li><a class="reference internal" href="#description-of-the-case">9.3. Description of the case</a></li>
<li><a class="reference internal" href="#parameter-file">9.4. Parameter file</a><ul>
<li><a class="reference internal" href="#simulation-control">9.4.1. Simulation control</a></li>
<li><a class="reference internal" href="#physical-properties">9.4.2. Physical properties</a></li>
<li><a class="reference internal" href="#mesh">9.4.3. Mesh</a></li>
<li><a class="reference internal" href="#boundary-conditions">9.4.4. Boundary conditions</a></li>
<li><a class="reference internal" href="#nitsche-immersed-boundary-parameters">9.4.5. Nitsche immersed boundary parameters</a></li>
<li><a class="reference internal" href="#post-processing">9.4.6. Post-processing</a></li>
<li><a class="reference internal" href="#non-linear-solver-parameters">9.4.7. Non-linear solver parameters</a></li>
<li><a class="reference internal" href="#linear-solver-parameters">9.4.8. Linear solver parameters</a></li>
</ul>
</li>
<li><a class="reference internal" href="#running-the-simulation">9.5. Running the simulation</a><ul>
<li><a class="reference internal" href="#results">9.5.1. Results</a></li>
</ul>
</li>
<li><a class="reference internal" href="#possibilities-for-extension">9.6. Possibilities for extension</a></li>
<li><a class="reference internal" href="#references">9.7. References</a></li>
</ul>
</li>
</ul>

          </div>
        </div>
      </div>
      
      
    </aside>
  </div>
</div><script data-url_root="../../../" id="documentation_options" src="../../../_static/documentation_options.js"></script>
    <script src="../../../_static/jquery.js"></script>
    <script src="../../../_static/underscore.js"></script>
    <script src="../../../_static/doctools.js"></script>
    <script src="../../../_static/scripts/furo.js"></script>
    <script async="async" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    </body>
</html>