<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.9.1"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>Developer documentation for the Lethe open-source library: /home/runner/work/lethe/lethe/include/solvers/mf_navier_stokes.h Source File</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
<link href="stylesheet.css" rel="stylesheet" type="text/css"/>
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectlogo"><img alt="Logo" src="logo.png"/></td>
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">Developer documentation for the Lethe open-source library
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.9.1 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "search",false,'Search','.html');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */</script>
<div id="main-nav"></div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><a class="el" href="dir_d44c64559bbebec7f509842c48db8b23.html">include</a></li><li class="navelem"><a class="el" href="dir_949292de90bec6ca0ef87cb838b26113.html">solvers</a></li>  </ul>
</div>
</div><!-- top -->
<div class="header">
  <div class="headertitle">
<div class="title">mf_navier_stokes.h</div>  </div>
</div><!--header-->
<div class="contents">
<a href="mf__navier__stokes_8h.html">Go to the documentation of this file.</a><div class="fragment"><div class="line"><a name="l00001"></a><span class="lineno">    1</span>&#160;<span class="comment">/* ---------------------------------------------------------------------</span></div>
<div class="line"><a name="l00002"></a><span class="lineno">    2</span>&#160;<span class="comment"> *</span></div>
<div class="line"><a name="l00003"></a><span class="lineno">    3</span>&#160;<span class="comment"> * Copyright (C) 2019 - by the Lethe authors</span></div>
<div class="line"><a name="l00004"></a><span class="lineno">    4</span>&#160;<span class="comment"> *</span></div>
<div class="line"><a name="l00005"></a><span class="lineno">    5</span>&#160;<span class="comment"> * This file is part of the Lethe library</span></div>
<div class="line"><a name="l00006"></a><span class="lineno">    6</span>&#160;<span class="comment"> *</span></div>
<div class="line"><a name="l00007"></a><span class="lineno">    7</span>&#160;<span class="comment"> * The Lethe library is free software; you can use it, redistribute</span></div>
<div class="line"><a name="l00008"></a><span class="lineno">    8</span>&#160;<span class="comment"> * it, and/or modify it under the terms of the GNU Lesser General</span></div>
<div class="line"><a name="l00009"></a><span class="lineno">    9</span>&#160;<span class="comment"> * Public License as published by the Free Software Foundation; either</span></div>
<div class="line"><a name="l00010"></a><span class="lineno">   10</span>&#160;<span class="comment"> * version 2.1 of the License, or (at your option) any later version.</span></div>
<div class="line"><a name="l00011"></a><span class="lineno">   11</span>&#160;<span class="comment"> * The full text of the license can be found in the file LICENSE at</span></div>
<div class="line"><a name="l00012"></a><span class="lineno">   12</span>&#160;<span class="comment"> * the top level of the Lethe distribution.</span></div>
<div class="line"><a name="l00013"></a><span class="lineno">   13</span>&#160;<span class="comment"> *</span></div>
<div class="line"><a name="l00014"></a><span class="lineno">   14</span>&#160;<span class="comment"> * ---------------------------------------------------------------------*/</span></div>
<div class="line"><a name="l00015"></a><span class="lineno">   15</span>&#160; </div>
<div class="line"><a name="l00016"></a><span class="lineno">   16</span>&#160;<span class="preprocessor">#ifndef lethe_mf_navier_stokes_h</span></div>
<div class="line"><a name="l00017"></a><span class="lineno">   17</span>&#160;<span class="preprocessor">#define lethe_mf_navier_stokes_h</span></div>
<div class="line"><a name="l00018"></a><span class="lineno">   18</span>&#160; </div>
<div class="line"><a name="l00019"></a><span class="lineno">   19</span>&#160;<span class="preprocessor">#include &lt;<a class="code" href="exceptions_8h.html">core/exceptions.h</a>&gt;</span></div>
<div class="line"><a name="l00020"></a><span class="lineno">   20</span>&#160; </div>
<div class="line"><a name="l00021"></a><span class="lineno">   21</span>&#160;<span class="preprocessor">#include &lt;<a class="code" href="mf__navier__stokes__operators_8h.html">solvers/mf_navier_stokes_operators.h</a>&gt;</span></div>
<div class="line"><a name="l00022"></a><span class="lineno">   22</span>&#160;<span class="preprocessor">#include &lt;<a class="code" href="navier__stokes__base_8h.html">solvers/navier_stokes_base.h</a>&gt;</span></div>
<div class="line"><a name="l00023"></a><span class="lineno">   23</span>&#160; </div>
<div class="line"><a name="l00024"></a><span class="lineno">   24</span>&#160;<span class="preprocessor">#include &lt;deal.II/lac/solver_gmres.h&gt;</span></div>
<div class="line"><a name="l00025"></a><span class="lineno">   25</span>&#160; </div>
<div class="line"><a name="l00026"></a><span class="lineno">   26</span>&#160;<span class="preprocessor">#include &lt;deal.II/multigrid/mg_transfer_global_coarsening.h&gt;</span></div>
<div class="line"><a name="l00027"></a><span class="lineno">   27</span>&#160;<span class="preprocessor">#include &lt;deal.II/multigrid/mg_transfer_matrix_free.h&gt;</span></div>
<div class="line"><a name="l00028"></a><span class="lineno">   28</span>&#160;<span class="preprocessor">#include &lt;deal.II/multigrid/multigrid.h&gt;</span></div>
<div class="line"><a name="l00029"></a><span class="lineno">   29</span>&#160; </div>
<div class="line"><a name="l00030"></a><span class="lineno">   30</span>&#160; </div>
<div class="line"><a name="l00031"></a><span class="lineno">   31</span>&#160;<span class="keyword">using namespace </span>dealii;</div>
<div class="line"><a name="l00032"></a><span class="lineno">   32</span>&#160; </div>
<div class="line"><a name="l00033"></a><span class="lineno">   33</span>&#160; </div>
<div class="line"><a name="l00041"></a><span class="lineno">   41</span>&#160;<span class="keyword">template</span> &lt;<span class="keywordtype">int</span> dim&gt;</div>
<div class="line"><a name="l00042"></a><span class="lineno"><a class="line" href="classMFNavierStokesSolver.html">   42</a></span>&#160;<span class="keyword">class </span><a class="code" href="classMFNavierStokesSolver.html">MFNavierStokesSolver</a></div>
<div class="line"><a name="l00043"></a><span class="lineno">   43</span>&#160;  : <span class="keyword">public</span> <a class="code" href="classNavierStokesBase.html">NavierStokesBase</a>&lt;dim,</div>
<div class="line"><a name="l00044"></a><span class="lineno">   44</span>&#160;                            LinearAlgebra::distributed::Vector&lt;double&gt;,</div>
<div class="line"><a name="l00045"></a><span class="lineno">   45</span>&#160;                            IndexSet&gt;</div>
<div class="line"><a name="l00046"></a><span class="lineno">   46</span>&#160;{</div>
<div class="line"><a name="l00047"></a><span class="lineno"><a class="line" href="classMFNavierStokesSolver.html#a4ea44b5505821708cea9efedd49efae7">   47</a></span>&#160;  <span class="keyword">using</span> <a class="code" href="classMFNavierStokesSolver.html#a4ea44b5505821708cea9efedd49efae7">VectorType</a>     = LinearAlgebra::distributed::Vector&lt;double&gt;;</div>
<div class="line"><a name="l00048"></a><span class="lineno"><a class="line" href="classMFNavierStokesSolver.html#a7590b310c9a4b2cb5ee8e5712dc84889">   48</a></span>&#160;  <span class="keyword">using</span> <a class="code" href="classMFNavierStokesSolver.html#a7590b310c9a4b2cb5ee8e5712dc84889">LSTransferType</a> = MGTransferMatrixFree&lt;dim, double&gt;;</div>
<div class="line"><a name="l00049"></a><span class="lineno"><a class="line" href="classMFNavierStokesSolver.html#ac75aa49660cb3ca173acbb97b5980e62">   49</a></span>&#160;  <span class="keyword">using</span> <a class="code" href="classMFNavierStokesSolver.html#ac75aa49660cb3ca173acbb97b5980e62">GCTransferType</a> = MGTransferGlobalCoarsening&lt;dim, VectorType&gt;;</div>
<div class="line"><a name="l00050"></a><span class="lineno">   50</span>&#160; </div>
<div class="line"><a name="l00051"></a><span class="lineno">   51</span>&#160;<span class="keyword">public</span>:</div>
<div class="line"><a name="l00057"></a><span class="lineno"><a class="line" href="classMFNavierStokesSolver.html#a969b7f3f6eaafd22e3b990da526f0335">   57</a></span>&#160;  <a class="code" href="classMFNavierStokesSolver.html#a969b7f3f6eaafd22e3b990da526f0335">MFNavierStokesSolver</a>(<a class="code" href="classSimulationParameters.html">SimulationParameters&lt;dim&gt;</a> &amp;nsparam);</div>
<div class="line"><a name="l00058"></a><span class="lineno">   58</span>&#160; </div>
<div class="line"><a name="l00063"></a><span class="lineno"><a class="line" href="classMFNavierStokesSolver.html#a9559907cbea42874378d74a8b7af9198">   63</a></span>&#160;  <a class="code" href="classMFNavierStokesSolver.html#a9559907cbea42874378d74a8b7af9198">~MFNavierStokesSolver</a>();</div>
<div class="line"><a name="l00064"></a><span class="lineno">   64</span>&#160; </div>
<div class="line"><a name="l00071"></a><span class="lineno">   71</span>&#160;  <span class="keyword">virtual</span> <span class="keywordtype">void</span></div>
<div class="line"><a name="l00072"></a><span class="lineno"><a class="line" href="classMFNavierStokesSolver.html#af38295c860a9becc539bc89b53c36d94">   72</a></span>&#160;  <a class="code" href="classMFNavierStokesSolver.html#af38295c860a9becc539bc89b53c36d94">solve</a>();</div>
<div class="line"><a name="l00073"></a><span class="lineno">   73</span>&#160; </div>
<div class="line"><a name="l00074"></a><span class="lineno">   74</span>&#160;<span class="keyword">protected</span>:</div>
<div class="line"><a name="l00078"></a><span class="lineno">   78</span>&#160;  <span class="keyword">virtual</span> <span class="keywordtype">void</span></div>
<div class="line"><a name="l00079"></a><span class="lineno"><a class="line" href="classMFNavierStokesSolver.html#a7beeb160a90f357147b5ed9a638d4dad">   79</a></span>&#160;  <a class="code" href="classMFNavierStokesSolver.html#a7beeb160a90f357147b5ed9a638d4dad">setup_dofs_fd</a>() <span class="keyword">override</span>;</div>
<div class="line"><a name="l00080"></a><span class="lineno">   80</span>&#160; </div>
<div class="line"><a name="l00084"></a><span class="lineno">   84</span>&#160;  <span class="keywordtype">void</span></div>
<div class="line"><a name="l00085"></a><span class="lineno"><a class="line" href="classMFNavierStokesSolver.html#af98460272fc891dec419ddcfff04b572">   85</a></span>&#160;  <a class="code" href="classMFNavierStokesSolver.html#af98460272fc891dec419ddcfff04b572">update_boundary_conditions</a>();</div>
<div class="line"><a name="l00086"></a><span class="lineno">   86</span>&#160; </div>
<div class="line"><a name="l00100"></a><span class="lineno">  100</span>&#160;  <span class="keyword">virtual</span> <span class="keywordtype">void</span></div>
<div class="line"><a name="l00101"></a><span class="lineno"><a class="line" href="classMFNavierStokesSolver.html#a1b4da7cd6e7b597300c9f35c81fbfbf4">  101</a></span>&#160;  <a class="code" href="classMFNavierStokesSolver.html#a1b4da7cd6e7b597300c9f35c81fbfbf4">set_initial_condition_fd</a>(</div>
<div class="line"><a name="l00102"></a><span class="lineno">  102</span>&#160;    <a class="code" href="namespaceParameters.html#a86eaa101a59015fa52c81783382dd525">Parameters::InitialConditionType</a> initial_condition_type,</div>
<div class="line"><a name="l00103"></a><span class="lineno">  103</span>&#160;    <span class="keywordtype">bool</span>                             restart = <span class="keyword">false</span>) <span class="keyword">override</span>;</div>
<div class="line"><a name="l00104"></a><span class="lineno">  104</span>&#160; </div>
<div class="line"><a name="l00109"></a><span class="lineno">  109</span>&#160;  <span class="keyword">virtual</span> <span class="keywordtype">void</span></div>
<div class="line"><a name="l00110"></a><span class="lineno"><a class="line" href="classMFNavierStokesSolver.html#aed51f11ae6b6191fef8ef169e120b134">  110</a></span>&#160;  <a class="code" href="classMFNavierStokesSolver.html#aed51f11ae6b6191fef8ef169e120b134">assemble_system_matrix</a>() <span class="keyword">override</span>;</div>
<div class="line"><a name="l00111"></a><span class="lineno">  111</span>&#160; </div>
<div class="line"><a name="l00115"></a><span class="lineno">  115</span>&#160;  <span class="keyword">virtual</span> <span class="keywordtype">void</span></div>
<div class="line"><a name="l00116"></a><span class="lineno"><a class="line" href="classMFNavierStokesSolver.html#a54a0ce53b73fa7c6d46dcf58e6274885">  116</a></span>&#160;  <a class="code" href="classMFNavierStokesSolver.html#a54a0ce53b73fa7c6d46dcf58e6274885">assemble_system_rhs</a>() <span class="keyword">override</span>;</div>
<div class="line"><a name="l00117"></a><span class="lineno">  117</span>&#160; </div>
<div class="line"><a name="l00121"></a><span class="lineno">  121</span>&#160;  <span class="keyword">virtual</span> <span class="keywordtype">void</span></div>
<div class="line"><a name="l00122"></a><span class="lineno"><a class="line" href="classMFNavierStokesSolver.html#ae836cb81c2a62a31625bfc316f5b5b7e">  122</a></span>&#160;  <a class="code" href="classMFNavierStokesSolver.html#ae836cb81c2a62a31625bfc316f5b5b7e">update_multiphysics_time_average_solution</a>() <span class="keyword">override</span>;</div>
<div class="line"><a name="l00123"></a><span class="lineno">  123</span>&#160; </div>
<div class="line"><a name="l00128"></a><span class="lineno">  128</span>&#160;  <span class="keywordtype">void</span></div>
<div class="line"><a name="l00129"></a><span class="lineno"><a class="line" href="classMFNavierStokesSolver.html#a6b5a5db326b972b6952e4de504b37c3a">  129</a></span>&#160;  <a class="code" href="classMFNavierStokesSolver.html#a6b5a5db326b972b6952e4de504b37c3a">calculate_time_derivative_previous_solutions</a>();</div>
<div class="line"><a name="l00130"></a><span class="lineno">  130</span>&#160; </div>
<div class="line"><a name="l00134"></a><span class="lineno">  134</span>&#160;  <span class="keywordtype">void</span></div>
<div class="line"><a name="l00135"></a><span class="lineno"><a class="line" href="classMFNavierStokesSolver.html#a36ee51f20461c472e94356be1aefe366">  135</a></span>&#160;  <a class="code" href="classMFNavierStokesSolver.html#a36ee51f20461c472e94356be1aefe366">define_non_zero_constraints</a>();</div>
<div class="line"><a name="l00136"></a><span class="lineno">  136</span>&#160; </div>
<div class="line"><a name="l00140"></a><span class="lineno">  140</span>&#160;  <span class="keywordtype">void</span></div>
<div class="line"><a name="l00141"></a><span class="lineno"><a class="line" href="classMFNavierStokesSolver.html#a7819d7e88ae634babd18975e2dfc6531">  141</a></span>&#160;  <a class="code" href="classMFNavierStokesSolver.html#a7819d7e88ae634babd18975e2dfc6531">define_zero_constraints</a>();</div>
<div class="line"><a name="l00142"></a><span class="lineno">  142</span>&#160; </div>
<div class="line"><a name="l00156"></a><span class="lineno">  156</span>&#160;  <span class="keywordtype">void</span></div>
<div class="line"><a name="l00157"></a><span class="lineno"><a class="line" href="classMFNavierStokesSolver.html#aaa38bbad875b3be70f5b17b085423335">  157</a></span>&#160;  <a class="code" href="classMFNavierStokesSolver.html#aaa38bbad875b3be70f5b17b085423335">solve_linear_system</a>(<span class="keyword">const</span> <span class="keywordtype">bool</span> initial_step,</div>
<div class="line"><a name="l00158"></a><span class="lineno">  158</span>&#160;                      <span class="keyword">const</span> <span class="keywordtype">bool</span> renewed_matrix = <span class="keyword">true</span>) <span class="keyword">override</span>;</div>
<div class="line"><a name="l00159"></a><span class="lineno">  159</span>&#160; </div>
<div class="line"><a name="l00160"></a><span class="lineno">  160</span>&#160;<span class="keyword">private</span>:</div>
<div class="line"><a name="l00166"></a><span class="lineno">  166</span>&#160;  <span class="keywordtype">void</span></div>
<div class="line"><a name="l00167"></a><span class="lineno"><a class="line" href="classMFNavierStokesSolver.html#a65880d1eefb2ddd76b9786fe21155370">  167</a></span>&#160;  <a class="code" href="classMFNavierStokesSolver.html#a65880d1eefb2ddd76b9786fe21155370">assemble_L2_projection</a>();</div>
<div class="line"><a name="l00168"></a><span class="lineno">  168</span>&#160; </div>
<div class="line"><a name="l00172"></a><span class="lineno">  172</span>&#160;  <span class="keywordtype">void</span></div>
<div class="line"><a name="l00173"></a><span class="lineno"><a class="line" href="classMFNavierStokesSolver.html#a0230071d873c750a689746b9ac776166">  173</a></span>&#160;  <a class="code" href="classMFNavierStokesSolver.html#a0230071d873c750a689746b9ac776166">solve_system_GMRES</a>(<span class="keyword">const</span> <span class="keywordtype">bool</span>   initial_step,</div>
<div class="line"><a name="l00174"></a><span class="lineno">  174</span>&#160;                     <span class="keyword">const</span> <span class="keywordtype">double</span> absolute_residual,</div>
<div class="line"><a name="l00175"></a><span class="lineno">  175</span>&#160;                     <span class="keyword">const</span> <span class="keywordtype">double</span> relative_residual);</div>
<div class="line"><a name="l00176"></a><span class="lineno">  176</span>&#160; </div>
<div class="line"><a name="l00180"></a><span class="lineno">  180</span>&#160;  <span class="keywordtype">void</span></div>
<div class="line"><a name="l00181"></a><span class="lineno"><a class="line" href="classMFNavierStokesSolver.html#a6bd8d73ded922b6616f909d5991ddbf2">  181</a></span>&#160;  <a class="code" href="classMFNavierStokesSolver.html#a6bd8d73ded922b6616f909d5991ddbf2">solve_with_LSMG</a>(SolverGMRES&lt;VectorType&gt; &amp;solver);</div>
<div class="line"><a name="l00182"></a><span class="lineno">  182</span>&#160; </div>
<div class="line"><a name="l00186"></a><span class="lineno">  186</span>&#160;  <span class="keywordtype">void</span></div>
<div class="line"><a name="l00187"></a><span class="lineno"><a class="line" href="classMFNavierStokesSolver.html#ad6c7376c7eba32e504941a26a1a10511">  187</a></span>&#160;  <a class="code" href="classMFNavierStokesSolver.html#ad6c7376c7eba32e504941a26a1a10511">solve_with_GCMG</a>(SolverGMRES&lt;VectorType&gt; &amp;solver);</div>
<div class="line"><a name="l00188"></a><span class="lineno">  188</span>&#160; </div>
<div class="line"><a name="l00192"></a><span class="lineno">  192</span>&#160;  <span class="keywordtype">void</span></div>
<div class="line"><a name="l00193"></a><span class="lineno"><a class="line" href="classMFNavierStokesSolver.html#ab62df740512f34c0d7a4dfe0f1d2f294">  193</a></span>&#160;  <a class="code" href="classMFNavierStokesSolver.html#ab62df740512f34c0d7a4dfe0f1d2f294">solve_with_ILU</a>(SolverGMRES&lt;VectorType&gt; &amp;solver);</div>
<div class="line"><a name="l00194"></a><span class="lineno">  194</span>&#160; </div>
<div class="line"><a name="l00207"></a><span class="lineno">  207</span>&#160;  <span class="keywordtype">double</span></div>
<div class="line"><a name="l00208"></a><span class="lineno"><a class="line" href="classMFNavierStokesSolver.html#ad9ea8cc85bc51ff8d8aa749f3bc84ace">  208</a></span>&#160;  <a class="code" href="classMFNavierStokesSolver.html#ad9ea8cc85bc51ff8d8aa749f3bc84ace">estimate_omega</a>(</div>
<div class="line"><a name="l00209"></a><span class="lineno">  209</span>&#160;    std::shared_ptr&lt;<a class="code" href="classNavierStokesOperatorBase.html">NavierStokesOperatorBase&lt;dim, double&gt;</a>&gt; &amp;mg_operator,</div>
<div class="line"><a name="l00210"></a><span class="lineno">  210</span>&#160;    <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span>                                     &amp;level,</div>
<div class="line"><a name="l00211"></a><span class="lineno">  211</span>&#160;    <span class="keyword">const</span> <a class="code" href="classMFNavierStokesSolver.html#a4ea44b5505821708cea9efedd49efae7">VectorType</a>                                       &amp;diagonal);</div>
<div class="line"><a name="l00212"></a><span class="lineno">  212</span>&#160; </div>
<div class="line"><a name="l00213"></a><span class="lineno">  213</span>&#160;<span class="keyword">protected</span>:</div>
<div class="line"><a name="l00214"></a><span class="lineno">  214</span>&#160;  <span class="comment">// Matrix-free operator</span></div>
<div class="line"><a name="l00215"></a><span class="lineno"><a class="line" href="classMFNavierStokesSolver.html#ab4ba4ab507512c88af8dd28705ca8323">  215</a></span>&#160;  std::shared_ptr&lt;NavierStokesOperatorBase&lt;dim, double&gt;&gt; <a class="code" href="classMFNavierStokesSolver.html#ab4ba4ab507512c88af8dd28705ca8323">system_operator</a>;</div>
<div class="line"><a name="l00216"></a><span class="lineno">  216</span>&#160;  <span class="comment">// Preconditioners</span></div>
<div class="line"><a name="l00217"></a><span class="lineno">  217</span>&#160;  std::shared_ptr&lt;PreconditionMG&lt;dim, VectorType, LSTransferType&gt;&gt;</div>
<div class="line"><a name="l00218"></a><span class="lineno"><a class="line" href="classMFNavierStokesSolver.html#a1335e4874da4efff5dbdd3908239b5b7">  218</a></span>&#160;    <a class="code" href="classMFNavierStokesSolver.html#a1335e4874da4efff5dbdd3908239b5b7">ls_multigrid_preconditioner</a>;</div>
<div class="line"><a name="l00219"></a><span class="lineno">  219</span>&#160;  std::shared_ptr&lt;PreconditionMG&lt;dim, VectorType, GCTransferType&gt;&gt;</div>
<div class="line"><a name="l00220"></a><span class="lineno"><a class="line" href="classMFNavierStokesSolver.html#a230bc9a19aded528b61c704cba054694">  220</a></span>&#160;    <a class="code" href="classMFNavierStokesSolver.html#a230bc9a19aded528b61c704cba054694">gc_multigrid_preconditioner</a>;</div>
<div class="line"><a name="l00221"></a><span class="lineno"><a class="line" href="classMFNavierStokesSolver.html#ac18339346c8aa010a603562dcecdb836">  221</a></span>&#160;  std::shared_ptr&lt;TrilinosWrappers::PreconditionILU&gt; <a class="code" href="classMFNavierStokesSolver.html#ac18339346c8aa010a603562dcecdb836">ilu_preconditioner</a>;</div>
<div class="line"><a name="l00222"></a><span class="lineno">  222</span>&#160;  <span class="comment">// Vector to store the time derivative of the previous solutions at the end</span></div>
<div class="line"><a name="l00223"></a><span class="lineno">  223</span>&#160;  <span class="comment">// of each time step</span></div>
<div class="line"><a name="l00224"></a><span class="lineno"><a class="line" href="classMFNavierStokesSolver.html#a4b6cceacb17fd93b7718ae5b98da291d">  224</a></span>&#160;  <a class="code" href="classMFNavierStokesSolver.html#a4ea44b5505821708cea9efedd49efae7">VectorType</a> <a class="code" href="classMFNavierStokesSolver.html#a4b6cceacb17fd93b7718ae5b98da291d">time_derivative_previous_solutions</a>;</div>
<div class="line"><a name="l00225"></a><span class="lineno">  225</span>&#160;  <span class="comment">// Setup timings for all MG components</span></div>
<div class="line"><a name="l00226"></a><span class="lineno"><a class="line" href="classMFNavierStokesSolver.html#a8962feeca1b55725c2dac833bebaaa93">  226</a></span>&#160;  TimerOutput <a class="code" href="classMFNavierStokesSolver.html#a8962feeca1b55725c2dac833bebaaa93">mg_computing_timer</a>;</div>
<div class="line"><a name="l00227"></a><span class="lineno">  227</span>&#160;};</div>
<div class="line"><a name="l00228"></a><span class="lineno">  228</span>&#160; </div>
<div class="line"><a name="l00229"></a><span class="lineno">  229</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="ttc" id="aclassMFNavierStokesSolver_html"><div class="ttname"><a href="classMFNavierStokesSolver.html">MFNavierStokesSolver</a></div><div class="ttdoc">A solver class for the Navier-Stokes equation that uses the matrix free approach.</div><div class="ttdef"><b>Definition:</b> mf_navier_stokes.h:46</div></div>
<div class="ttc" id="aclassMFNavierStokesSolver_html_a0230071d873c750a689746b9ac776166"><div class="ttname"><a href="classMFNavierStokesSolver.html#a0230071d873c750a689746b9ac776166">MFNavierStokesSolver::solve_system_GMRES</a></div><div class="ttdeci">void solve_system_GMRES(const bool initial_step, const double absolute_residual, const double relative_residual)</div><div class="ttdoc">GMRES solver with preconditioning.</div></div>
<div class="ttc" id="aclassMFNavierStokesSolver_html_a1335e4874da4efff5dbdd3908239b5b7"><div class="ttname"><a href="classMFNavierStokesSolver.html#a1335e4874da4efff5dbdd3908239b5b7">MFNavierStokesSolver::ls_multigrid_preconditioner</a></div><div class="ttdeci">std::shared_ptr&lt; PreconditionMG&lt; dim, VectorType, LSTransferType &gt; &gt; ls_multigrid_preconditioner</div><div class="ttdef"><b>Definition:</b> mf_navier_stokes.h:218</div></div>
<div class="ttc" id="aclassMFNavierStokesSolver_html_a1b4da7cd6e7b597300c9f35c81fbfbf4"><div class="ttname"><a href="classMFNavierStokesSolver.html#a1b4da7cd6e7b597300c9f35c81fbfbf4">MFNavierStokesSolver::set_initial_condition_fd</a></div><div class="ttdeci">virtual void set_initial_condition_fd(Parameters::InitialConditionType initial_condition_type, bool restart=false) override</div><div class="ttdoc">Set the initial conditions for the solver.</div></div>
<div class="ttc" id="aclassMFNavierStokesSolver_html_a230bc9a19aded528b61c704cba054694"><div class="ttname"><a href="classMFNavierStokesSolver.html#a230bc9a19aded528b61c704cba054694">MFNavierStokesSolver::gc_multigrid_preconditioner</a></div><div class="ttdeci">std::shared_ptr&lt; PreconditionMG&lt; dim, VectorType, GCTransferType &gt; &gt; gc_multigrid_preconditioner</div><div class="ttdef"><b>Definition:</b> mf_navier_stokes.h:220</div></div>
<div class="ttc" id="aclassMFNavierStokesSolver_html_a36ee51f20461c472e94356be1aefe366"><div class="ttname"><a href="classMFNavierStokesSolver.html#a36ee51f20461c472e94356be1aefe366">MFNavierStokesSolver::define_non_zero_constraints</a></div><div class="ttdeci">void define_non_zero_constraints()</div><div class="ttdoc">Define the non-zero constraints used to solve the problem.</div></div>
<div class="ttc" id="aclassMFNavierStokesSolver_html_a4b6cceacb17fd93b7718ae5b98da291d"><div class="ttname"><a href="classMFNavierStokesSolver.html#a4b6cceacb17fd93b7718ae5b98da291d">MFNavierStokesSolver::time_derivative_previous_solutions</a></div><div class="ttdeci">VectorType time_derivative_previous_solutions</div><div class="ttdef"><b>Definition:</b> mf_navier_stokes.h:224</div></div>
<div class="ttc" id="aclassMFNavierStokesSolver_html_a4ea44b5505821708cea9efedd49efae7"><div class="ttname"><a href="classMFNavierStokesSolver.html#a4ea44b5505821708cea9efedd49efae7">MFNavierStokesSolver::VectorType</a></div><div class="ttdeci">LinearAlgebra::distributed::Vector&lt; double &gt; VectorType</div><div class="ttdef"><b>Definition:</b> mf_navier_stokes.h:47</div></div>
<div class="ttc" id="aclassMFNavierStokesSolver_html_a54a0ce53b73fa7c6d46dcf58e6274885"><div class="ttname"><a href="classMFNavierStokesSolver.html#a54a0ce53b73fa7c6d46dcf58e6274885">MFNavierStokesSolver::assemble_system_rhs</a></div><div class="ttdeci">virtual void assemble_system_rhs() override</div><div class="ttdoc">Assemble the system rhs associated with the solver.</div></div>
<div class="ttc" id="aclassMFNavierStokesSolver_html_a65880d1eefb2ddd76b9786fe21155370"><div class="ttname"><a href="classMFNavierStokesSolver.html#a65880d1eefb2ddd76b9786fe21155370">MFNavierStokesSolver::assemble_L2_projection</a></div><div class="ttdeci">void assemble_L2_projection()</div><div class="ttdoc">Assembles an L2_projection matrix for the velocity and the pressure. This L2 projection matrix can be...</div></div>
<div class="ttc" id="aclassMFNavierStokesSolver_html_a6b5a5db326b972b6952e4de504b37c3a"><div class="ttname"><a href="classMFNavierStokesSolver.html#a6b5a5db326b972b6952e4de504b37c3a">MFNavierStokesSolver::calculate_time_derivative_previous_solutions</a></div><div class="ttdeci">void calculate_time_derivative_previous_solutions()</div><div class="ttdoc">Calculate and store time derivatives of previous solutions according to time-stepping scheme to use t...</div></div>
<div class="ttc" id="aclassMFNavierStokesSolver_html_a6bd8d73ded922b6616f909d5991ddbf2"><div class="ttname"><a href="classMFNavierStokesSolver.html#a6bd8d73ded922b6616f909d5991ddbf2">MFNavierStokesSolver::solve_with_LSMG</a></div><div class="ttdeci">void solve_with_LSMG(SolverGMRES&lt; VectorType &gt; &amp;solver)</div><div class="ttdoc">Set-up local smoothing MG preconditioner.</div></div>
<div class="ttc" id="aclassMFNavierStokesSolver_html_a7590b310c9a4b2cb5ee8e5712dc84889"><div class="ttname"><a href="classMFNavierStokesSolver.html#a7590b310c9a4b2cb5ee8e5712dc84889">MFNavierStokesSolver::LSTransferType</a></div><div class="ttdeci">MGTransferMatrixFree&lt; dim, double &gt; LSTransferType</div><div class="ttdef"><b>Definition:</b> mf_navier_stokes.h:48</div></div>
<div class="ttc" id="aclassMFNavierStokesSolver_html_a7819d7e88ae634babd18975e2dfc6531"><div class="ttname"><a href="classMFNavierStokesSolver.html#a7819d7e88ae634babd18975e2dfc6531">MFNavierStokesSolver::define_zero_constraints</a></div><div class="ttdeci">void define_zero_constraints()</div><div class="ttdoc">Define the zero constraints used to solve the problem.</div></div>
<div class="ttc" id="aclassMFNavierStokesSolver_html_a7beeb160a90f357147b5ed9a638d4dad"><div class="ttname"><a href="classMFNavierStokesSolver.html#a7beeb160a90f357147b5ed9a638d4dad">MFNavierStokesSolver::setup_dofs_fd</a></div><div class="ttdeci">virtual void setup_dofs_fd() override</div><div class="ttdoc">Setup the DoFs, system operator and solution vectors.</div></div>
<div class="ttc" id="aclassMFNavierStokesSolver_html_a8962feeca1b55725c2dac833bebaaa93"><div class="ttname"><a href="classMFNavierStokesSolver.html#a8962feeca1b55725c2dac833bebaaa93">MFNavierStokesSolver::mg_computing_timer</a></div><div class="ttdeci">TimerOutput mg_computing_timer</div><div class="ttdef"><b>Definition:</b> mf_navier_stokes.h:226</div></div>
<div class="ttc" id="aclassMFNavierStokesSolver_html_a9559907cbea42874378d74a8b7af9198"><div class="ttname"><a href="classMFNavierStokesSolver.html#a9559907cbea42874378d74a8b7af9198">MFNavierStokesSolver::~MFNavierStokesSolver</a></div><div class="ttdeci">~MFNavierStokesSolver()</div><div class="ttdoc">Destroy the MFNavierStokesSolver object.</div></div>
<div class="ttc" id="aclassMFNavierStokesSolver_html_a969b7f3f6eaafd22e3b990da526f0335"><div class="ttname"><a href="classMFNavierStokesSolver.html#a969b7f3f6eaafd22e3b990da526f0335">MFNavierStokesSolver::MFNavierStokesSolver</a></div><div class="ttdeci">MFNavierStokesSolver(SimulationParameters&lt; dim &gt; &amp;nsparam)</div><div class="ttdoc">Construct a new MFNavierStokesSolver object.</div></div>
<div class="ttc" id="aclassMFNavierStokesSolver_html_aaa38bbad875b3be70f5b17b085423335"><div class="ttname"><a href="classMFNavierStokesSolver.html#aaa38bbad875b3be70f5b17b085423335">MFNavierStokesSolver::solve_linear_system</a></div><div class="ttdeci">void solve_linear_system(const bool initial_step, const bool renewed_matrix=true) override</div><div class="ttdoc">Call for the assembly of the linear system of equations.</div></div>
<div class="ttc" id="aclassMFNavierStokesSolver_html_ab4ba4ab507512c88af8dd28705ca8323"><div class="ttname"><a href="classMFNavierStokesSolver.html#ab4ba4ab507512c88af8dd28705ca8323">MFNavierStokesSolver::system_operator</a></div><div class="ttdeci">std::shared_ptr&lt; NavierStokesOperatorBase&lt; dim, double &gt; &gt; system_operator</div><div class="ttdef"><b>Definition:</b> mf_navier_stokes.h:215</div></div>
<div class="ttc" id="aclassMFNavierStokesSolver_html_ab62df740512f34c0d7a4dfe0f1d2f294"><div class="ttname"><a href="classMFNavierStokesSolver.html#ab62df740512f34c0d7a4dfe0f1d2f294">MFNavierStokesSolver::solve_with_ILU</a></div><div class="ttdeci">void solve_with_ILU(SolverGMRES&lt; VectorType &gt; &amp;solver)</div><div class="ttdoc">Set-up ILU preconditioner.</div></div>
<div class="ttc" id="aclassMFNavierStokesSolver_html_ac18339346c8aa010a603562dcecdb836"><div class="ttname"><a href="classMFNavierStokesSolver.html#ac18339346c8aa010a603562dcecdb836">MFNavierStokesSolver::ilu_preconditioner</a></div><div class="ttdeci">std::shared_ptr&lt; TrilinosWrappers::PreconditionILU &gt; ilu_preconditioner</div><div class="ttdef"><b>Definition:</b> mf_navier_stokes.h:221</div></div>
<div class="ttc" id="aclassMFNavierStokesSolver_html_ac75aa49660cb3ca173acbb97b5980e62"><div class="ttname"><a href="classMFNavierStokesSolver.html#ac75aa49660cb3ca173acbb97b5980e62">MFNavierStokesSolver::GCTransferType</a></div><div class="ttdeci">MGTransferGlobalCoarsening&lt; dim, VectorType &gt; GCTransferType</div><div class="ttdef"><b>Definition:</b> mf_navier_stokes.h:49</div></div>
<div class="ttc" id="aclassMFNavierStokesSolver_html_ad6c7376c7eba32e504941a26a1a10511"><div class="ttname"><a href="classMFNavierStokesSolver.html#ad6c7376c7eba32e504941a26a1a10511">MFNavierStokesSolver::solve_with_GCMG</a></div><div class="ttdeci">void solve_with_GCMG(SolverGMRES&lt; VectorType &gt; &amp;solver)</div><div class="ttdoc">Set-up global coarsening MG preconditioner.</div></div>
<div class="ttc" id="aclassMFNavierStokesSolver_html_ad9ea8cc85bc51ff8d8aa749f3bc84ace"><div class="ttname"><a href="classMFNavierStokesSolver.html#ad9ea8cc85bc51ff8d8aa749f3bc84ace">MFNavierStokesSolver::estimate_omega</a></div><div class="ttdeci">double estimate_omega(std::shared_ptr&lt; NavierStokesOperatorBase&lt; dim, double &gt;&gt; &amp;mg_operator, const unsigned int &amp;level, const VectorType &amp;diagonal)</div><div class="ttdoc">Estimate the eigenvalues to obtain a relaxation parameter for the MG smoother.</div></div>
<div class="ttc" id="aclassMFNavierStokesSolver_html_ae836cb81c2a62a31625bfc316f5b5b7e"><div class="ttname"><a href="classMFNavierStokesSolver.html#ae836cb81c2a62a31625bfc316f5b5b7e">MFNavierStokesSolver::update_multiphysics_time_average_solution</a></div><div class="ttdeci">virtual void update_multiphysics_time_average_solution() override</div><div class="ttdoc">Update the average velocity field solution in the multiphyscics interface.</div></div>
<div class="ttc" id="aclassMFNavierStokesSolver_html_aed51f11ae6b6191fef8ef169e120b134"><div class="ttname"><a href="classMFNavierStokesSolver.html#aed51f11ae6b6191fef8ef169e120b134">MFNavierStokesSolver::assemble_system_matrix</a></div><div class="ttdeci">virtual void assemble_system_matrix() override</div><div class="ttdoc">Assemble the matrix associated with the solver. This function is only required for compilation and it...</div></div>
<div class="ttc" id="aclassMFNavierStokesSolver_html_af38295c860a9becc539bc89b53c36d94"><div class="ttname"><a href="classMFNavierStokesSolver.html#af38295c860a9becc539bc89b53c36d94">MFNavierStokesSolver::solve</a></div><div class="ttdeci">virtual void solve()</div><div class="ttdoc">Solves the Navier-Stokes problem.</div></div>
<div class="ttc" id="aclassMFNavierStokesSolver_html_af98460272fc891dec419ddcfff04b572"><div class="ttname"><a href="classMFNavierStokesSolver.html#af98460272fc891dec419ddcfff04b572">MFNavierStokesSolver::update_boundary_conditions</a></div><div class="ttdeci">void update_boundary_conditions()</div><div class="ttdoc">Update non zero constraints if the boundary is time dependent.</div></div>
<div class="ttc" id="aclassNavierStokesBase_html"><div class="ttname"><a href="classNavierStokesBase.html">NavierStokesBase</a></div><div class="ttdef"><b>Definition:</b> navier_stokes_base.h:78</div></div>
<div class="ttc" id="aclassNavierStokesOperatorBase_html"><div class="ttname"><a href="classNavierStokesOperatorBase.html">NavierStokesOperatorBase</a></div><div class="ttdoc">A class that serves as base for all the matrix-free Navier-Stokes operators.</div><div class="ttdef"><b>Definition:</b> mf_navier_stokes_operators.h:46</div></div>
<div class="ttc" id="aclassSimulationParameters_html"><div class="ttname"><a href="classSimulationParameters.html">SimulationParameters</a></div><div class="ttdef"><b>Definition:</b> simulation_parameters.h:38</div></div>
<div class="ttc" id="aexceptions_8h_html"><div class="ttname"><a href="exceptions_8h.html">exceptions.h</a></div></div>
<div class="ttc" id="amf__navier__stokes__operators_8h_html"><div class="ttname"><a href="mf__navier__stokes__operators_8h.html">mf_navier_stokes_operators.h</a></div></div>
<div class="ttc" id="anamespaceParameters_html_a86eaa101a59015fa52c81783382dd525"><div class="ttname"><a href="namespaceParameters.html#a86eaa101a59015fa52c81783382dd525">Parameters::InitialConditionType</a></div><div class="ttdeci">InitialConditionType</div><div class="ttdef"><b>Definition:</b> initial_conditions.h:35</div></div>
<div class="ttc" id="anavier__stokes__base_8h_html"><div class="ttname"><a href="navier__stokes__base_8h.html">navier_stokes_base.h</a></div></div>
</div><!-- fragment --></div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by&#160;<a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.9.1
</small></address>
</body>
</html>
