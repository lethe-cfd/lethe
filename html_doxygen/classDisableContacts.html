<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.9.1"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>Developer documentation for the Lethe open-source library: DisableContacts&lt; dim &gt; Class Template Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
<link href="stylesheet.css" rel="stylesheet" type="text/css"/>
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectlogo"><img alt="Logo" src="logo.png"/></td>
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">Developer documentation for the Lethe open-source library
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.9.1 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "search",false,'Search','.html');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */</script>
<div id="main-nav"></div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

</div><!-- top -->
<div class="header">
  <div class="summary">
<a href="#pub-types">Public Types</a> &#124;
<a href="#pub-methods">Public Member Functions</a> &#124;
<a href="#pri-methods">Private Member Functions</a> &#124;
<a href="#pri-attribs">Private Attributes</a> &#124;
<a href="classDisableContacts-members.html">List of all members</a>  </div>
  <div class="headertitle">
<div class="title">DisableContacts&lt; dim &gt; Class Template Reference</div>  </div>
</div><!--header-->
<div class="contents">

<p><code>#include &lt;<a class="el" href="disable__contacts_8h_source.html">disable_contacts.h</a>&gt;</code></p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="pub-types"></a>
Public Types</h2></td></tr>
<tr class="memitem:a6a5eede6395adcd9f9b0c06e3905ab81"><td class="memItemLeft" align="right" valign="top">enum &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classDisableContacts.html#a6a5eede6395adcd9f9b0c06e3905ab81">mobility_status</a> : unsigned int { <a class="el" href="classDisableContacts.html#a6a5eede6395adcd9f9b0c06e3905ab81ae94519a7191fcc98769dc95a1b84aa47">inactive</a> = 0
, <a class="el" href="classDisableContacts.html#a6a5eede6395adcd9f9b0c06e3905ab81a099fcb56d879cd214833de782687c718">active</a> = 1
, <a class="el" href="classDisableContacts.html#a6a5eede6395adcd9f9b0c06e3905ab81a4afce95fbdea4e993953ac73339e2036">mobile</a> = 2
, <a class="el" href="classDisableContacts.html#a6a5eede6395adcd9f9b0c06e3905ab81ae41c22c26ab3e611ac6bec6dbc042df9">empty</a> = 3
 }</td></tr>
<tr class="separator:a6a5eede6395adcd9f9b0c06e3905ab81"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="pub-methods"></a>
Public Member Functions</h2></td></tr>
<tr class="memitem:ae40b02afe4b33cf89297372703fe56d0"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classDisableContacts.html#ae40b02afe4b33cf89297372703fe56d0">DisableContacts</a> ()</td></tr>
<tr class="separator:ae40b02afe4b33cf89297372703fe56d0"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a51fa7b1453c88c2cfb41a7af46902363"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classDisableContacts.html#a51fa7b1453c88c2cfb41a7af46902363">update_local_and_ghost_cell_set</a> (const DoFHandler&lt; dim &gt; &amp;background_dh)</td></tr>
<tr class="memdesc:a51fa7b1453c88c2cfb41a7af46902363"><td class="mdescLeft">&#160;</td><td class="mdescRight">Create or update a set of the active and ghost cells so that we don't have to loop over all the cells in the triangulation for the granular temperature and solid fraction calculation, and during the identification of the mobility status. This set prevent 4 iteration steps over all the cells + the verification if the cell is locally owned, ghost or not. This set is updated at every load balance step since cells are redistributed among processors.  <a href="classDisableContacts.html#a51fa7b1453c88c2cfb41a7af46902363">More...</a><br /></td></tr>
<tr class="separator:a51fa7b1453c88c2cfb41a7af46902363"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa1b7dfee81da1ae8a4d3aec86092f883"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classDisableContacts.html#aa1b7dfee81da1ae8a4d3aec86092f883">identify_mobility_status</a> (const DoFHandler&lt; dim &gt; &amp;background_dh, const Particles::ParticleHandler&lt; dim &gt; &amp;particle_handler, const unsigned int n_active_cells, MPI_Comm mpi_communicator)</td></tr>
<tr class="memdesc:aa1b7dfee81da1ae8a4d3aec86092f883"><td class="mdescLeft">&#160;</td><td class="mdescRight">Carries out the identification of the mobility status of each cell through a node-based identification and check. Only the active and ghost cells are processed.  <a href="classDisableContacts.html#aa1b7dfee81da1ae8a4d3aec86092f883">More...</a><br /></td></tr>
<tr class="separator:aa1b7dfee81da1ae8a4d3aec86092f883"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a4cf8368bfc4c6568c0f88c4ce07b06de"><td class="memItemLeft" align="right" valign="top">unsigned int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classDisableContacts.html#a4cf8368bfc4c6568c0f88c4ce07b06de">check_cell_mobility</a> (const typename Triangulation&lt; dim &gt;::active_cell_iterator &amp;cell) const</td></tr>
<tr class="memdesc:a4cf8368bfc4c6568c0f88c4ce07b06de"><td class="mdescLeft">&#160;</td><td class="mdescRight">Find the mobility status of a cell.  <a href="classDisableContacts.html#a4cf8368bfc4c6568c0f88c4ce07b06de">More...</a><br /></td></tr>
<tr class="separator:a4cf8368bfc4c6568c0f88c4ce07b06de"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad36a9809f7e46e4c0ae7cc22a1050523"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classDisableContacts.html#ad36a9809f7e46e4c0ae7cc22a1050523">set_threshold_values</a> (const double granular_temperature, const double solid_fraction)</td></tr>
<tr class="memdesc:ad36a9809f7e46e4c0ae7cc22a1050523"><td class="mdescLeft">&#160;</td><td class="mdescRight">Set the threshold values for the mobile status criteria (granular temperature and solid fraction)  <a href="classDisableContacts.html#ad36a9809f7e46e4c0ae7cc22a1050523">More...</a><br /></td></tr>
<tr class="separator:ad36a9809f7e46e4c0ae7cc22a1050523"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af63e1e48e35b6cac7eadf1246af22603"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classDisableContacts.html#af63e1e48e35b6cac7eadf1246af22603">get_mobility_status_vector</a> (Vector&lt; float &gt; &amp;status)</td></tr>
<tr class="memdesc:af63e1e48e35b6cac7eadf1246af22603"><td class="mdescLeft">&#160;</td><td class="mdescRight">Convert the map of mobility status to a vector of mobility status because map can't be used as is in the pvd post-processing or any data out, it needs to be converted to a vector of mobility status by active cell index.  <a href="classDisableContacts.html#af63e1e48e35b6cac7eadf1246af22603">More...</a><br /></td></tr>
<tr class="separator:af63e1e48e35b6cac7eadf1246af22603"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aad923eda4cebe4a7ba332cb57f308fd9"><td class="memItemLeft" align="right" valign="top"><a class="el" href="structDEM_1_1dem__data__structures.html">DEM::dem_data_structures</a>&lt; dim &gt;::cell_index_int_map &amp;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classDisableContacts.html#aad923eda4cebe4a7ba332cb57f308fd9">get_mobility_status</a> ()</td></tr>
<tr class="separator:aad923eda4cebe4a7ba332cb57f308fd9"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="pri-methods"></a>
Private Member Functions</h2></td></tr>
<tr class="memitem:a9997435cd13f73e0f3e75d591bff16c1"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classDisableContacts.html#a9997435cd13f73e0f3e75d591bff16c1">calculate_granular_temperature_and_solid_fraction</a> (const Particles::ParticleHandler&lt; dim &gt; &amp;particle_handler, const std::set&lt; typename DoFHandler&lt; dim &gt;::active_cell_iterator &gt; &amp;local_and_ghost_cells_with_particles, Vector&lt; double &gt; &amp;cell_granular_temperature, Vector&lt; double &gt; &amp;cell_solid_fraction)</td></tr>
<tr class="memdesc:a9997435cd13f73e0f3e75d591bff16c1"><td class="mdescLeft">&#160;</td><td class="mdescRight">Carries out the calculation of the granular temperature and solid fraction approximation (pcm method) in each active cell. Those values are criteria for cell mobility.  <a href="classDisableContacts.html#a9997435cd13f73e0f3e75d591bff16c1">More...</a><br /></td></tr>
<tr class="separator:a9997435cd13f73e0f3e75d591bff16c1"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="pri-attribs"></a>
Private Attributes</h2></td></tr>
<tr class="memitem:a067034921ded9d88e81a405244324fce"><td class="memItemLeft" align="right" valign="top"><a class="el" href="structDEM_1_1dem__data__structures.html">DEM::dem_data_structures</a>&lt; dim &gt;::cell_index_int_map&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classDisableContacts.html#a067034921ded9d88e81a405244324fce">cell_mobility_status</a></td></tr>
<tr class="separator:a067034921ded9d88e81a405244324fce"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:adc3624d4787f7078ca508fe594f97910"><td class="memItemLeft" align="right" valign="top">std::set&lt; typename DoFHandler&lt; dim &gt;::active_cell_iterator &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classDisableContacts.html#adc3624d4787f7078ca508fe594f97910">local_and_ghost_cells</a></td></tr>
<tr class="separator:adc3624d4787f7078ca508fe594f97910"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a4208535a4406b99833ae8b1ab8081e5a"><td class="memItemLeft" align="right" valign="top">LinearAlgebra::distributed::Vector&lt; int &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classDisableContacts.html#a4208535a4406b99833ae8b1ab8081e5a">mobility_at_nodes</a></td></tr>
<tr class="separator:a4208535a4406b99833ae8b1ab8081e5a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa137a91e76ca97665123aaaa1b90e8cf"><td class="memItemLeft" align="right" valign="top">double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classDisableContacts.html#aa137a91e76ca97665123aaaa1b90e8cf">granular_temperature_threshold</a></td></tr>
<tr class="separator:aa137a91e76ca97665123aaaa1b90e8cf"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aca9875d4c4afb450d0a45703b6b251b6"><td class="memItemLeft" align="right" valign="top">double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classDisableContacts.html#aca9875d4c4afb450d0a45703b6b251b6">solid_fraction_threshold</a></td></tr>
<tr class="separator:aca9875d4c4afb450d0a45703b6b251b6"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><h3>template&lt;int dim&gt;<br />
class DisableContacts&lt; dim &gt;</h3>

<p>The general idea behind the algorithm: It uses the granular temperature to determinate if particles in a cell are mobile enough that the contact forces are worth computation. A cell having a granular temperature under a value (default is 1e-4) will have an inactive status which makes them rejected in the broad search step. This results in no contact forces or velocity integration in future steps for those particles, which make less computation cost for the simulation.</p>
<p>Cells may be flagged as that called mobility status:</p><ul>
<li>mobile (everything is calculated as if feature is not enabled)</li>
<li>active (particles with low motion next to mobile particles)</li>
<li>inactive (particles are not in a neighbor’s candidate list of cells around)</li>
</ul>
<p>There are some edge cases that need some attention. In these cases, particles in cells can't be deactivated:</p>
<ol type="1">
<li>The solid fraction of the cell is under a value (default = 40%): particles in the cell may have other forces that can move them and it is supposed that with this fraction, there is not enough particles around to hold them in their position.</li>
<li>Cells having empty cell neighbors: it means that particles are next to a floating wall/mesh and they may have a change of contact forces from it if the wall disappears or is moving.</li>
<li>The cell has cell neighbors which is flagged as mobile from the 3 criteria mentioned above (granular temperature, solid fractions or floating walls): this is because motion is badly propagated to particles to the cell around without this additional "layer" of mobile cells.</li>
<li>The cell has cell neighbors which is flagged as mobile from the previous criterion (additional layer of mobile cells): this is again to allow the propagation of motion, but only the particles in contact with particles from the mobile cells are considered for the contact force calculation but their position is not computed at the integration step. Those cells are flagged as active cells. It works with the assignment and verification of the mobility status at nodes to check the status of the neighboring cells. </li>
</ol>
</div><h2 class="groupheader">Member Enumeration Documentation</h2>
<a id="a6a5eede6395adcd9f9b0c06e3905ab81"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a6a5eede6395adcd9f9b0c06e3905ab81">&#9670;&nbsp;</a></span>mobility_status</h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;int dim&gt; </div>
      <table class="memname">
        <tr>
          <td class="memname">enum <a class="el" href="classDisableContacts.html#a6a5eede6395adcd9f9b0c06e3905ab81">DisableContacts::mobility_status</a> : unsigned int</td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Mobility status flag used to identify the status at nodes and the status of the cell:</p>
<p>inactive (0) The movement of particles in the cell is considered as negligible, particles within this cell are not considered in the contact detection (rejected at the broad search step), so no force calculation or integration is applied</p>
<p>active (1) The movement of particles in the cell is considered as negligible, but there's at least one neighbor cell that is flagged as mobile, meaning that particles need to be in contact candidates lists at the broad search step, particles directly in contact with the mobile cell are also considered in force calculation, but none of the particles in the cell are integrated.</p>
<p>mobile (2) The movement of particles in the cell is significant or there is at least one neighbor cell that is mobile by criteria (see the <a class="el" href="classDisableContacts.html#aa1b7dfee81da1ae8a4d3aec86092f883" title="Carries out the identification of the mobility status of each cell through a node-based identificatio...">identify_mobility_status()</a> description), particles need to be in contact candidates lists at the broad search step and particles are treated as usual (force calculation and integration)</p>
<p>empty (3) This status is only used for the node-based mobility status identification, no cells are flagged as empty, only node can by identify as empty. Without this identification of the empty cells, we can't identify the cell that have a empty neighbor cell, which is critical for simulationd using floating walls or mesh </p>
<table class="fieldtable">
<tr><th colspan="2">Enumerator</th></tr><tr><td class="fieldname"><a id="a6a5eede6395adcd9f9b0c06e3905ab81ae94519a7191fcc98769dc95a1b84aa47"></a>inactive&#160;</td><td class="fielddoc"></td></tr>
<tr><td class="fieldname"><a id="a6a5eede6395adcd9f9b0c06e3905ab81a099fcb56d879cd214833de782687c718"></a>active&#160;</td><td class="fielddoc"></td></tr>
<tr><td class="fieldname"><a id="a6a5eede6395adcd9f9b0c06e3905ab81a4afce95fbdea4e993953ac73339e2036"></a>mobile&#160;</td><td class="fielddoc"></td></tr>
<tr><td class="fieldname"><a id="a6a5eede6395adcd9f9b0c06e3905ab81ae41c22c26ab3e611ac6bec6dbc042df9"></a>empty&#160;</td><td class="fielddoc"></td></tr>
</table>

</div>
</div>
<h2 class="groupheader">Constructor &amp; Destructor Documentation</h2>
<a id="ae40b02afe4b33cf89297372703fe56d0"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ae40b02afe4b33cf89297372703fe56d0">&#9670;&nbsp;</a></span>DisableContacts()</h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;int dim&gt; </div>
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classDisableContacts.html">DisableContacts</a>&lt; dim &gt;::<a class="el" href="classDisableContacts.html">DisableContacts</a> </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<h2 class="groupheader">Member Function Documentation</h2>
<a id="a9997435cd13f73e0f3e75d591bff16c1"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a9997435cd13f73e0f3e75d591bff16c1">&#9670;&nbsp;</a></span>calculate_granular_temperature_and_solid_fraction()</h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;int dim&gt; </div>
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void <a class="el" href="classDisableContacts.html">DisableContacts</a>&lt; dim &gt;::calculate_granular_temperature_and_solid_fraction </td>
          <td>(</td>
          <td class="paramtype">const Particles::ParticleHandler&lt; dim &gt; &amp;&#160;</td>
          <td class="paramname"><em>particle_handler</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const std::set&lt; typename DoFHandler&lt; dim &gt;::active_cell_iterator &gt; &amp;&#160;</td>
          <td class="paramname"><em>local_and_ghost_cells_with_particles</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">Vector&lt; double &gt; &amp;&#160;</td>
          <td class="paramname"><em>cell_granular_temperature</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">Vector&lt; double &gt; &amp;&#160;</td>
          <td class="paramname"><em>cell_solid_fraction</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Carries out the calculation of the granular temperature and solid fraction approximation (pcm method) in each active cell. Those values are criteria for cell mobility. </p>
<p>solid fraction = n particles * particle volume / cell volume</p>
<p>Granular temperature:</p><ol type="1">
<li>average velocity of cell = sum of particle velocity / n_particles</li>
<li>average of cell velocity fluctuation squared = sum of particle velocity fluctuation squared / n_particles</li>
<li>granular temperature = sum of average of cell velocity fluctuation squared / dim</li>
</ol>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">particle_handler</td><td>The particle handler that contains all the particles</td></tr>
    <tr><td class="paramname">current_local_and_ghost_cells</td><td>The set of locally owned and ghost cells that empty cells are removed from</td></tr>
    <tr><td class="paramname">cell_granular_temperature</td><td>The empty vector of granular temperature</td></tr>
    <tr><td class="paramname">cell_solid_fraction</td><td>The empty vector of solid fraction </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a id="a4cf8368bfc4c6568c0f88c4ce07b06de"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a4cf8368bfc4c6568c0f88c4ce07b06de">&#9670;&nbsp;</a></span>check_cell_mobility()</h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;int dim&gt; </div>
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">unsigned int <a class="el" href="classDisableContacts.html">DisableContacts</a>&lt; dim &gt;::check_cell_mobility </td>
          <td>(</td>
          <td class="paramtype">const typename Triangulation&lt; dim &gt;::active_cell_iterator &amp;&#160;</td>
          <td class="paramname"><em>cell</em></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Find the mobility status of a cell. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">cell</td><td>The iterator of the cell that needs mobility evaluation </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a id="aad923eda4cebe4a7ba332cb57f308fd9"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aad923eda4cebe4a7ba332cb57f308fd9">&#9670;&nbsp;</a></span>get_mobility_status()</h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;int dim&gt; </div>
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="structDEM_1_1dem__data__structures.html">DEM::dem_data_structures</a>&lt;dim&gt;::cell_index_int_map&amp; <a class="el" href="classDisableContacts.html">DisableContacts</a>&lt; dim &gt;::get_mobility_status </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

</div>
</div>
<a id="af63e1e48e35b6cac7eadf1246af22603"></a>
<h2 class="memtitle"><span class="permalink"><a href="#af63e1e48e35b6cac7eadf1246af22603">&#9670;&nbsp;</a></span>get_mobility_status_vector()</h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;int dim&gt; </div>
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void <a class="el" href="classDisableContacts.html">DisableContacts</a>&lt; dim &gt;::get_mobility_status_vector </td>
          <td>(</td>
          <td class="paramtype">Vector&lt; float &gt; &amp;&#160;</td>
          <td class="paramname"><em>status</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Convert the map of mobility status to a vector of mobility status because map can't be used as is in the pvd post-processing or any data out, it needs to be converted to a vector of mobility status by active cell index. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">status</td><td>The initiated vector for the conversion </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a id="aa1b7dfee81da1ae8a4d3aec86092f883"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aa1b7dfee81da1ae8a4d3aec86092f883">&#9670;&nbsp;</a></span>identify_mobility_status()</h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;int dim&gt; </div>
      <table class="memname">
        <tr>
          <td class="memname">void <a class="el" href="classDisableContacts.html">DisableContacts</a>&lt; dim &gt;::identify_mobility_status </td>
          <td>(</td>
          <td class="paramtype">const DoFHandler&lt; dim &gt; &amp;&#160;</td>
          <td class="paramname"><em>background_dh</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const Particles::ParticleHandler&lt; dim &gt; &amp;&#160;</td>
          <td class="paramname"><em>particle_handler</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const unsigned int&#160;</td>
          <td class="paramname"><em>n_active_cells</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">MPI_Comm&#160;</td>
          <td class="paramname"><em>mpi_communicator</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Carries out the identification of the mobility status of each cell through a node-based identification and check. Only the active and ghost cells are processed. </p>
<p>The following 4 checks (search loops) are done:</p>
<ol type="1">
<li>Check if the cell is empty (n_particle = 0), if so, nodes and cells are flagged as empty mobility status (3)</li>
<li>Check if the cell is mobile by criteria (average granular temperature &gt; threshold, solid fraction &lt; threshold or has at least one empty node from previous check), if so, nodes are flagged and cells are stored with mobile mobility status (2)</li>
<li>Check if the cell is mobile by neighbor (at least a node is flagged as mobile from previous check), if so, cells are stored in map as mobile status (2) and nodes that are not mobile are flagged as active (1)</li>
<li>Check if the cell is active (at least a node is flagged as active from previous check), if so, cells are stored with active status in the map (1)</li>
</ol>
<p>The remaining cells are inactive (0)</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">background_dh</td><td>The dof handler of the background grid</td></tr>
    <tr><td class="paramname">particle_handler</td><td>The particle handler that contains all the particles</td></tr>
    <tr><td class="paramname">mpi_communicator</td><td>The MPI communicator </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a id="ad36a9809f7e46e4c0ae7cc22a1050523"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ad36a9809f7e46e4c0ae7cc22a1050523">&#9670;&nbsp;</a></span>set_threshold_values()</h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;int dim&gt; </div>
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void <a class="el" href="classDisableContacts.html">DisableContacts</a>&lt; dim &gt;::set_threshold_values </td>
          <td>(</td>
          <td class="paramtype">const double&#160;</td>
          <td class="paramname"><em>granular_temperature</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const double&#160;</td>
          <td class="paramname"><em>solid_fraction</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Set the threshold values for the mobile status criteria (granular temperature and solid fraction) </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">granular_temperature</td><td>The threshold value for the granular temperature</td></tr>
    <tr><td class="paramname">solid_fraction</td><td>The threshold value for the solid fraction (volume of particles in the cell) </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a id="a51fa7b1453c88c2cfb41a7af46902363"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a51fa7b1453c88c2cfb41a7af46902363">&#9670;&nbsp;</a></span>update_local_and_ghost_cell_set()</h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;int dim&gt; </div>
      <table class="memname">
        <tr>
          <td class="memname">void <a class="el" href="classDisableContacts.html">DisableContacts</a>&lt; dim &gt;::update_local_and_ghost_cell_set </td>
          <td>(</td>
          <td class="paramtype">const DoFHandler&lt; dim &gt; &amp;&#160;</td>
          <td class="paramname"><em>background_dh</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Create or update a set of the active and ghost cells so that we don't have to loop over all the cells in the triangulation for the granular temperature and solid fraction calculation, and during the identification of the mobility status. This set prevent 4 iteration steps over all the cells + the verification if the cell is locally owned, ghost or not. This set is updated at every load balance step since cells are redistributed among processors. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">background_dh</td><td>The DoFHandler of the background grid </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<h2 class="groupheader">Member Data Documentation</h2>
<a id="a067034921ded9d88e81a405244324fce"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a067034921ded9d88e81a405244324fce">&#9670;&nbsp;</a></span>cell_mobility_status</h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;int dim&gt; </div>
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="structDEM_1_1dem__data__structures.html">DEM::dem_data_structures</a>&lt;dim&gt;::cell_index_int_map <a class="el" href="classDisableContacts.html">DisableContacts</a>&lt; dim &gt;::cell_mobility_status</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

</div>
</div>
<a id="aa137a91e76ca97665123aaaa1b90e8cf"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aa137a91e76ca97665123aaaa1b90e8cf">&#9670;&nbsp;</a></span>granular_temperature_threshold</h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;int dim&gt; </div>
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">double <a class="el" href="classDisableContacts.html">DisableContacts</a>&lt; dim &gt;::granular_temperature_threshold</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

</div>
</div>
<a id="adc3624d4787f7078ca508fe594f97910"></a>
<h2 class="memtitle"><span class="permalink"><a href="#adc3624d4787f7078ca508fe594f97910">&#9670;&nbsp;</a></span>local_and_ghost_cells</h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;int dim&gt; </div>
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">std::set&lt;typename DoFHandler&lt;dim&gt;::active_cell_iterator&gt; <a class="el" href="classDisableContacts.html">DisableContacts</a>&lt; dim &gt;::local_and_ghost_cells</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

</div>
</div>
<a id="a4208535a4406b99833ae8b1ab8081e5a"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a4208535a4406b99833ae8b1ab8081e5a">&#9670;&nbsp;</a></span>mobility_at_nodes</h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;int dim&gt; </div>
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">LinearAlgebra::distributed::Vector&lt;int&gt; <a class="el" href="classDisableContacts.html">DisableContacts</a>&lt; dim &gt;::mobility_at_nodes</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

</div>
</div>
<a id="aca9875d4c4afb450d0a45703b6b251b6"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aca9875d4c4afb450d0a45703b6b251b6">&#9670;&nbsp;</a></span>solid_fraction_threshold</h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;int dim&gt; </div>
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">double <a class="el" href="classDisableContacts.html">DisableContacts</a>&lt; dim &gt;::solid_fraction_threshold</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

</div>
</div>
<hr/>The documentation for this class was generated from the following file:<ul>
<li>/home/runner/work/lethe/lethe/include/dem/<a class="el" href="disable__contacts_8h_source.html">disable_contacts.h</a></li>
</ul>
</div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by&#160;<a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.9.1
</small></address>
</body>
</html>
